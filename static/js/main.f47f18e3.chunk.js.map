{"version":3,"sources":["utils/index.js","App.js","index.js"],"names":["data","a","JSZipUtils","getBinaryContent","error","template","createReport","cmdDelimiter","report","saveDataToFile","fileName","mimeType","blob","Blob","type","url","window","URL","createObjectURL","downloadURL","setTimeout","revokeObjectURL","document","createElement","href","download","body","appendChild","style","click","remove","Item","createForm","form","getFieldProps","getFieldError","backgroundColor","rules","required","message","labelNumber","mode","title","initialValue","Date","onClick","validateFields","force","formData","getFieldsValue","detectDate","format","c","position","section","mValue1","mValue2","mValue3","console","log","genReport","ReactDOM","render","getElementById"],"mappings":"keAGO,WAAyBA,GAAzB,SAAAC,EAAA,sDAiBLC,IAAWC,iBACT,wBADF,uCAEE,WAAOC,EAAOC,GAAd,eAAAJ,EAAA,0DACMG,EADN,sBACmBA,EADnB,uBAEuBE,IAAa,CAChCD,WAWAL,OACAO,aAAc,CAAC,IAAK,OAfxB,OAEQC,EAFR,OAkBEC,EACED,EACA,cACA,2EArBJ,2CAFF,yDAjBK,4C,sBAiDP,IAUMC,EAAiB,SAACT,EAAMU,EAAUC,GACtC,IAAMC,EAAO,IAAIC,KAAK,CAACb,GAAO,CAAEc,KAAMH,IAChCI,EAAMC,OAAOC,IAAIC,gBAAgBN,GACvCO,EAAYJ,EAAKL,EAAUC,GAC3BS,YAAW,WACTJ,OAAOC,IAAII,gBAAgBN,KAC1B,MAGCI,EAAc,SAACnB,EAAMU,GACzB,IAAMT,EAAIqB,SAASC,cAAc,KACjCtB,EAAEuB,KAAOxB,EACTC,EAAEwB,SAAWf,EACbY,SAASI,KAAKC,YAAY1B,GAC1BA,EAAE2B,MAAQ,gBACV3B,EAAE4B,QACF5B,EAAE6B,U,OChEEC,EAAO,IAAKA,KAgHHC,qBA9Gf,YAAwB,IAATC,EAAQ,EAARA,KAyBLC,EAAiCD,EAAjCC,cAAeC,EAAkBF,EAAlBE,cACvB,OACE,8BACE,sBACA,oBAAMP,MAAO,CAAEQ,gBAAiB,OAAhC,UACE,2CACEhC,QAAS+B,EAAc,gBACnBD,EAAc,cAAe,CAC/BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAHvC,2CAQA,2CACEnC,QAAS+B,EAAc,iBACvBK,YAAa,GACTN,EAAc,gBAAiB,CACjCG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,6DASA,2CACEE,KAAK,OACLC,MAAM,4BACFR,EAAc,aAAc,CAC9BS,aAAc,IAAIC,KAClBP,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBALvC,aAQE,cAACR,EAAD,CAAM3B,QAAS+B,EAAc,cAA7B,yCAEF,2CACE/B,QAAS+B,EAAc,YACvBrB,KAAK,UACDoB,EAAc,WAAY,CAC5BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,2CASA,2CACEnC,QAAS+B,EAAc,aACnBD,EAAc,WAAY,CAC5BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAHvC,qCAQA,2CACEnC,QAAS+B,EAAc,WACvBrB,KAAK,UACDoB,EAAc,UAAW,CAC3BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,sCASA,2CACEnC,QAAS+B,EAAc,WACvBrB,KAAK,UACDoB,EAAc,UAAW,CAC3BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,sCASA,2CACEnC,QAAS+B,EAAc,WACvBrB,KAAK,UACDoB,EAAc,UAAW,CAC3BG,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,yCAUF,sBACA,mBAAQzB,KAAK,UAAU+B,QAhGP,WAClBZ,EAAKa,eAAe,CAAEC,OAAO,IAAQ,SAAC3C,GACpC,IAAKA,EAAO,CAEV,IAAM4C,EAAWf,EAAKgB,iBACtBD,EAASE,WAAaC,YAAOH,EAASE,WAAY,cAClD,IAAME,EAAI,CACRC,SAAUL,EAASK,SACnBC,QAAS,CAACN,EAASO,QAASP,EAASQ,QAASR,EAASS,UAEnDzD,EAAI,2BAAQgD,GAAR,IAAkBI,MAC5BM,QAAQC,IAAI3D,GD/Bb,SAAP,2BCgCQ4D,CAAU5D,QAoFZ,gCChHN6D,IAASC,OAAO,cAAC,EAAD,IAASxC,SAASyC,eAAe,W","file":"static/js/main.f47f18e3.chunk.js","sourcesContent":["import createReport from \"docx-templates\";\r\nimport JSZipUtils from \"jszip-utils\";\r\n\r\nexport async function genReport(data) {\r\n  //上传模版\r\n  // const template = await readFileIntoArrayBuffer(file);\r\n  // const report = await createReport({\r\n  //   template,\r\n  //   data: {\r\n  //     name: \"John\",\r\n  //     surname: \"Appleseed\",\r\n  //   },\r\n  //   cmdDelimiter: [\"{\", \"}\"],\r\n  // });\r\n  // saveDataToFile(\r\n  //   report,\r\n  //   \"report.docx\",\r\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n  // );\r\n\r\n  JSZipUtils.getBinaryContent(\r\n    \"./templates/F-05.docx\",\r\n    async (error, template) => {\r\n      if (error) throw error;\r\n      const report = await createReport({\r\n        template,\r\n        // data: {\r\n        //   projectName: \"测试项目\",\r\n        //   equipmentName: \"设备\",\r\n        //   detectDate: \"2021-4-15\",\r\n        //   reportNo: \"292831930\",\r\n        //   c: {\r\n        //     position: \"北\",\r\n        //     section: [23, 21, 36],\r\n        //   },\r\n        // },\r\n        data,\r\n        cmdDelimiter: [\"{\", \"}\"],\r\n      });\r\n      // Save report\r\n      saveDataToFile(\r\n        report,\r\n        \"report.docx\",\r\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n      );\r\n    }\r\n  );\r\n}\r\n\r\n// ==============================================\r\n// Helpers\r\n// ==============================================\r\nconst readFileIntoArrayBuffer = async (fd) =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onerror = reject;\r\n    reader.onload = () => {\r\n      resolve(reader.result);\r\n    };\r\n    reader.readAsArrayBuffer(fd);\r\n  });\r\n\r\nconst saveDataToFile = (data, fileName, mimeType) => {\r\n  const blob = new Blob([data], { type: mimeType });\r\n  const url = window.URL.createObjectURL(blob);\r\n  downloadURL(url, fileName, mimeType);\r\n  setTimeout(() => {\r\n    window.URL.revokeObjectURL(url);\r\n  }, 1000);\r\n};\r\n\r\nconst downloadURL = (data, fileName) => {\r\n  const a = document.createElement(\"a\");\r\n  a.href = data;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.style = \"display: none\";\r\n  a.click();\r\n  a.remove();\r\n};\r\n","// import logo from \"./logo.svg\";\r\nimport { format } from 'date-fns';\r\nimport { createForm } from 'rc-form';\r\nimport {\r\n  Button,\r\n  InputItem,\r\n  List,\r\n  DatePicker,\r\n  WingBlank,\r\n  WhiteSpace,\r\n} from 'antd-mobile';\r\nimport { genReport } from './utils/index';\r\n// import \"./App.css\";\r\n\r\nconst Item = List.Item;\r\n\r\nfunction App({ form }) {\r\n  //上传模版\r\n  // const fileInput = useRef(null);\r\n  // const handleClick = () => {\r\n  //   const file = fileInput.current.inputRef.inputRef.files[0];\r\n  //   genReport(file);\r\n  // };\r\n  const handleClick = () => {\r\n    form.validateFields({ force: true }, (error) => {\r\n      if (!error) {\r\n        // console.log(form.getFieldsValue());\r\n        const formData = form.getFieldsValue();\r\n        formData.detectDate = format(formData.detectDate, 'yyyy-MM-dd');\r\n        const c = {\r\n          position: formData.position,\r\n          section: [formData.mValue1, formData.mValue2, formData.mValue3],\r\n        };\r\n        const data = { ...formData, c };\r\n        console.log(data);\r\n        genReport(data);\r\n      } else {\r\n        // alert('验证失败');\r\n      }\r\n    });\r\n  };\r\n  const { getFieldProps, getFieldError } = form;\r\n  return (\r\n    <WingBlank>\r\n      <WhiteSpace />\r\n      <List style={{ backgroundColor: 'red' }}>\r\n        <InputItem\r\n          error={!!getFieldError('projectName')}\r\n          {...getFieldProps('projectName', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          项目名称\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('equipmentName')}\r\n          labelNumber={7}\r\n          {...getFieldProps('equipmentName', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          检测设备及名称\r\n        </InputItem>\r\n        <DatePicker\r\n          mode=\"date\"\r\n          title=\"选择日期\"\r\n          {...getFieldProps('detectDate', {\r\n            initialValue: new Date(),\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          <Item error={!!getFieldError('detectDate')}>检测时间</Item>\r\n        </DatePicker>\r\n        <InputItem\r\n          error={!!getFieldError('reportNo')}\r\n          type=\"number\"\r\n          {...getFieldProps('reportNo', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          报告编号\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('position')}\r\n          {...getFieldProps('position', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          柱位置\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('mValue1')}\r\n          type=\"number\"\r\n          {...getFieldProps('mValue1', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          实测值1\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('mValue2')}\r\n          type=\"number\"\r\n          {...getFieldProps('mValue2', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          实测值2\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('mValue3')}\r\n          type=\"number\"\r\n          {...getFieldProps('mValue3', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          实测值3\r\n        </InputItem>\r\n      </List>\r\n      <WhiteSpace />\r\n      <Button type=\"primary\" onClick={handleClick}>\r\n        导出\r\n      </Button>\r\n    </WingBlank>\r\n  );\r\n}\r\n\r\nexport default createForm()(App);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\n// import reportWebVitals from './reportWebVitals';\r\n// import { Button } from \"antd-mobile\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n// ReactDOM.render(<Button>Start</Button>, document.getElementById(\"root\"));\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n// reportWebVitals();\r\n"],"sourceRoot":""}