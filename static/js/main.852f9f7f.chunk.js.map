{"version":3,"sources":["components/Container.js","components/TemplateList.js","utils/indexDB.js","containers/Home.js","utils/index.js","containers/record/Edit.js","utils/docx.js","containers/record/List.js","index.js","containers/Main.js"],"names":["Container","children","navBar","header","mode","className","Item","templates","id","name","enable","withRouter","project","history","map","template","disabled","extra","onClick","sessionStorage","setItem","JSON","stringify","push","handleItemClick","db","initDB","a","Promise","resolve","reject","request","window","indexedDB","open","onupgradeneeded","event","target","result","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","createIndex","unique","onsuccess","onerror","console","error","insertData","store","data","transaction","objectStore","add","close","selectAllData","openCursor","cursor","item","value","continue","selectDataByIndex","indexName","params","range","IDBKeyRange","only","index","selectDataByKey","key","get","updateData","put","deleteData","delete","prompt","average","arr","length","reduce","accumulator","currentValue","parseInt","toFixed","fillArr","len","concat","Array","fill","chunk","i","records","slice","date","equip","handleRecords","list","property","object","paging","acc","obj","createForm","form","match","parse","getItem","useState","record","setRecord","useEffect","then","res","getFieldProps","getFieldError","title","initialValue","Date","labelNumber","rules","required","message","position","placeholder","section_s_m_1","section_s_m_2","section_s_m_3","bar","type","space_m_1","space_m_2","space_m_3","space_m_4","space_m_5","space_m_6","space_non_m_1","space_non_m_2","space_non_m_3","space_non_m_4","space_non_m_5","space_non_m_6","space_d","validateFields","force","fail","formData","getFieldsValue","format","projectId","templateId","section_s_a","space","space_m","join","space_a","space_non","space_non_m","space_non_a","goBack","reportName","JSZipUtils","getBinaryContent","createReport","cmdDelimiter","report","saveDataToFile","fileName","mimeType","blob","Blob","url","URL","createObjectURL","downloadURL","setTimeout","revokeObjectURL","document","createElement","href","download","body","appendChild","style","click","remove","alert","Rlist","columns","setColumns","animating","setAnimating","column","autoClose","right","text","onPress","newColumns","filter","backgroundColor","color","pages","genReport","projectName","toast","ReactDOM","render","path","exact","component","projects","setProjects","accordion","openAnimation","Panel","newProjects","List","Edit","to","getElementById"],"mappings":"iXAGe,SAASA,EAAT,GAAkD,IAA7BC,EAA4B,EAA5BA,SAAUC,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,OACpD,OACE,qCACE,mBAAQC,KAAK,OAAb,SAAqBF,IACpBC,EAAS,qBAAKE,UAAU,QAAf,SAAwBF,IAAgB,KAClD,8BACE,sBACCF,Q,mCCNHK,EAAO,IAAKA,KACZC,EAAY,CAChB,CACEC,GAAI,EACJC,KAAM,+DACNC,QAAQ,GAEV,CACEF,GAAI,EACJC,KAAM,+DACNC,QAAQ,GAEV,CACEF,GAAI,EACJC,KAAM,+DACNC,QAAQ,GAEV,CACEF,GAAI,EACJC,KAAM,+DACNC,QAAQ,IAgCGC,mBA5Bf,YAA6C,IAArBC,EAAoB,EAApBA,QAASC,EAAW,EAAXA,QAQ/B,OACE,4BACE,4BACGN,EAAUO,KAAI,SAACC,GAAD,OACb,cAACT,EAAD,CACEU,UAAWD,EAASL,OAEpBO,MAAOF,EAASL,OAAS,GAAK,qBAC9BQ,QAAS,YAfK,SAACH,GACnBA,EAASL,SACXS,eAAeC,QAAQ,aAAcC,KAAKC,UAAUV,IACpDO,eAAeC,QAAQ,cAAeC,KAAKC,UAAUP,IACrDF,EAAQU,KAAK,YAYLC,CAAgBT,IALpB,SAQGA,EAASN,MANLM,EAASP,c,yBC1CtBiB,EAAK,KAEHC,EAAM,uCAAG,sBAAAC,EAAA,sEACP,IAAIC,SAAQ,SAACC,EAASC,GAC1B,IAAMC,EAAUC,OAAOC,UAAUC,KAAK,SACtCH,EAAQI,gBAAkB,SAAUC,GAClC,IAAMX,EAAKW,EAAMC,OAAOC,OAEnBb,EAAGc,iBAAiBC,SAAS,aAEhCf,EAAGgB,kBAAkB,WAAY,CAC/BC,QAAS,KACTC,eAAe,IAGdlB,EAAGc,iBAAiBC,SAAS,YAElBf,EAAGgB,kBAAkB,UAAW,CAC5CC,QAAS,KACTC,eAAe,IAELC,YAAY,YAAa,YAAa,CAAEC,QAAQ,KAGhEd,EAAQe,UAAY,SAAUV,GAC5BX,EAAKW,EAAMC,OAAOC,OAClBT,EAAQJ,IAEVM,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAM,8DA5BL,mFAAH,qDAgCCC,EAAU,uCAAG,WAAOC,EAAOC,GAAd,SAAAzB,EAAA,sEAClBD,IADkB,uBAEX,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMC,EAAUN,EACb4B,YAAY,CAACF,GAAQ,aACrBG,YAAYH,GACZI,IAAIH,GACPrB,EAAQe,UAAY,SAAUV,GAC5B,IAAM5B,EAAK4B,EAAMC,OAAOC,OACxBT,EAAQrB,GACRiB,EAAG+B,SAGLzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDAfoB,mFAAH,wDAqBVM,EAAa,uCAAG,WAAON,GAAP,SAAAxB,EAAA,sEACrBD,IADqB,uBAEd,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMsB,EAAO,GACPrB,EAAUN,EACb4B,YAAYF,EAAO,YACnBG,YAAYH,GACZO,aACH3B,EAAQe,UAAY,SAAUV,GAC5B,IAAMuB,EAASvB,EAAMC,OAAOC,OAC5B,GAAIqB,EAAQ,CACV,IAAMC,EAAOD,EAAOE,MACpBT,EAAK7B,KAAKqC,GACVD,EAAOG,gBAEPjC,EAAQuB,GACR3B,EAAG+B,SAGPzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDArBuB,mFAAH,sDA2BbY,EAAiB,uCAAG,WAAOZ,EAAOa,EAAWC,GAAzB,SAAAtC,EAAA,sEACzBD,IADyB,uBAElB,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMsB,EAAO,GACPc,EAAQC,YAAYC,KAAKH,GACzBlC,EAAUN,EACb4B,YAAYF,EAAO,YACnBG,YAAYH,GACZkB,MAAML,GACNN,WAAWQ,GACdnC,EAAQe,UAAY,SAAUV,GAC5B,IAAMuB,EAASvB,EAAMC,OAAOC,OAC5B,GAAIqB,EAAQ,CACV,IAAMC,EAAOD,EAAOE,MACpBT,EAAK7B,KAAKqC,GACVD,EAAOG,gBAEPjC,EAAQuB,GACR3B,EAAG+B,SAGPzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDAvB2B,mFAAH,0DA6BjBmB,EAAe,uCAAG,WAAOnB,EAAOoB,GAAd,SAAA5C,EAAA,sEACvBD,IADuB,uBAEhB,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMC,EAAUN,EAAG4B,YAAYF,GAAOG,YAAYH,GAAOqB,IAAID,GAC7DxC,EAAQe,UAAY,SAAUV,GAC5B,IAAMgB,EAAOhB,EAAMC,OAAOC,OAC1BT,EAAQuB,GACR3B,EAAG+B,SAELzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDAXyB,mFAAH,wDAiBfsB,EAAU,uCAAG,WAAOtB,EAAOU,GAAd,SAAAlC,EAAA,sEAClBD,IADkB,uBAEX,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMC,EAAUN,EACb4B,YAAYF,EAAO,aACnBG,YAAYH,GACZuB,IAAIb,GACP9B,EAAQe,UAAY,WAClBjB,IACAJ,EAAG+B,SAELzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDAboB,mFAAH,wDAmBVwB,EAAU,uCAAG,WAAOxB,EAAOoB,GAAd,SAAA5C,EAAA,sEAClBD,IADkB,uBAEX,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMC,EAAUN,EACb4B,YAAYF,EAAO,aACnBG,YAAYH,GACZyB,OAAOL,GACVxC,EAAQe,UAAY,WAClBjB,IACAJ,EAAG+B,SAELzB,EAAQgB,QAAU,WAChBjB,IACAkB,QAAQC,MAAR,UAAiBE,EAAjB,mDAboB,mFAAH,wDC7IjB0B,EAAS,IAAMA,O,oICLRC,EAAU,SAACC,GAGtB,OAAOA,EAAIC,QAAUD,EAAIE,QAFT,SAACC,EAAaC,GAAd,OACdC,SAASF,GAAeE,SAASD,MACQJ,EAAIC,QAAQK,QAAQ,GAAK,IAIhEC,EAAU,SAACP,EAAKQ,EAAK1B,GACzB,OAAIkB,EAAIC,OAASO,EAAYR,EACtBA,EAAIS,OAAO,IAAIC,MAAMF,EAAMR,EAAIC,QAAQU,KAAK7B,KAI/C8B,EAAQ,SAACZ,EAAKQ,EAAKhB,GAEvB,IADA,IAAMjC,EAAS,GACNsD,EAAI,EAAGA,EAAIb,EAAIC,OAAQY,GAAKL,EACnCjD,EAAOf,KAAK,CACVsE,QAASP,EAAQP,EAAIe,MAAMF,EAAGA,EAAIL,GAAMA,EAAK,IAC7CQ,KAAMxB,EACNyB,MAAOjB,EAAIa,GAAGI,QAGlB,OAAO1D,GAyBI2D,GAAgB,SAACC,EAAMX,GAElC,IAvB4BY,EAyB5B,OAba,SAACC,EAAQb,GACtB,IAAIjD,EAAS,GACb,IAAK,IAAMiC,KAAO6B,EAChB9D,EAASA,EAAOkD,OAAOG,EAAMS,EAAO7B,GAAMgB,EAAKhB,IAEjD,OAAOjC,EAQA+D,EAzBqBF,EAuBD,OAAND,EAtBFjB,QAAO,SAAUqB,EAAKC,GACvC,IAAIhC,EAAMgC,EAAIJ,GAKd,OAJKG,EAAI/B,KACP+B,EAAI/B,GAAO,IAEb+B,EAAI/B,GAAKhD,KAAKgF,GACPD,IACN,KAiBiBf,ICpChBjF,GAAO,IAAKA,KAsSHkG,sBApSf,YAAyC,IAAzBC,EAAwB,EAAxBA,KAAM5F,EAAkB,EAAlBA,QAAS6F,EAAS,EAATA,MACvB9F,EAAUS,KAAKsF,MAAMxF,eAAeyF,QAAQ,eAC5C7F,EAAWM,KAAKsF,MAAMxF,eAAeyF,QAAQ,gBAFb,EAIVC,mBAAS,MAJC,mBAI/BC,EAJ+B,KAIvBC,EAJuB,KAMtCC,qBAAU,WACR,IAAM/C,EAASyC,EAAMzC,OACrB,GAAIA,EAAOzD,GAAI,CAEb,IAAMA,EAAKyD,EAAOzD,GAElB8D,EAAgB,UAAWc,SAAS5E,IAAKyG,MAAK,SAACC,GAC7CH,EAAUG,SAGb,CAACR,EAAMzC,SAhB4B,IAkB9BkD,EAAiCV,EAAjCU,cAAeC,EAAkBX,EAAlBW,cAkDvB,OACE,qCACE,8BACE,2CACEhH,KAAK,OACLiH,MAAM,4BACFF,EAAc,OAAQ,CACxBG,aAAcR,EAAS,IAAIS,KAAKT,EAAOf,MAAQ,IAAIwB,QAJvD,aAOE,cAAC,GAAD,0CAEF,2CACEC,YAAa,EACbvE,QAASmE,EAAc,UACnBD,EAAc,QAAS,CACzBG,aAAcR,EAASA,EAAOd,MAAQ,GACtCyB,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBALvC,6DAUA,2CACE1E,QAASmE,EAAc,aACnBD,EAAc,WAAY,CAC5BG,aAAcR,EAASA,EAAOc,SAAW,GACzCH,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,wCAUF,qBAAKtH,UAAU,YAAf,oDACA,8BACE,kBAAMC,KAAN,UACE,+BACEuH,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAOgB,cAAgB,SAIpD,kBAAMxH,KAAN,UACE,+BACEuH,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAOiB,cAAgB,SAIpD,kBAAMzH,KAAN,UACE,+BACEuH,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAOkB,cAAgB,YAKtD,qBAAK3H,UAAU,YAAf,sEACA,8BACE,kBAAMC,KAAN,UACE,+BACEuH,YAAY,8CACRV,EAAc,MAAO,CACvBG,aAAcR,EAASA,EAAOmB,IAAM,SAI1C,kBAAM3H,KAAN,OAEF,qBAAKD,UAAU,YAAf,sEACA,8BACE,kBAAMC,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAOqB,UAAY,SAIhD,kBAAM7H,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAOsB,UAAY,SAIhD,kBAAM9H,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAOuB,UAAY,YAKlD,sBACA,8BACE,kBAAM/H,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAOwB,UAAY,SAIhD,kBAAMhI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAOyB,UAAY,SAIhD,kBAAMjI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,YAAa,CAC7BG,aAAcR,EAASA,EAAO0B,UAAY,YAKlD,qBAAKnI,UAAU,YAAf,wFACA,8BACE,kBAAMC,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAO2B,cAAgB,SAIpD,kBAAMnI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAO4B,cAAgB,SAIpD,kBAAMpI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAO6B,cAAgB,YAKtD,sBACA,8BACE,kBAAMrI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAO8B,cAAgB,SAIpD,kBAAMtI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAO+B,cAAgB,SAIpD,kBAAMvI,KAAN,UACE,+BACE4H,KAAK,SACLL,YAAY,sBACRV,EAAc,gBAAiB,CACjCG,aAAcR,EAASA,EAAOgC,cAAgB,YAKtD,8BACE,mBAAMxI,KAAN,WACE,qBAAKD,UAAU,YAAf,gEACA,+BACE6H,KAAK,SACLL,YAAY,wCACRV,EAAc,UAAW,CAC3BG,aAAcR,EAASA,EAAOiC,QAAU,UAI9C,mBAAMzI,KAAN,WACE,qBAAKD,UAAU,YAAf,0DACA,+BACE6H,KAAK,SACLL,YAAY,kCACRV,EAAc,SAAU,CAC1BG,aAAcR,EAASA,EAAO9B,OAAS,aAK/C,sBAIA,mBAAQkD,KAAK,UAAUhH,QAzQP,WAClBuF,EAAKuC,eAAe,CAAEC,OAAO,IAAQ,SAAChG,GACpC,GAAKA,EAyCH,IAAMiG,KAAK,6CAAW,OAzCZ,CACV,IAAMC,EAAW1C,EAAK2C,iBACtBD,EAASpD,KAAOsD,YAAOF,EAASpD,KAAM,cACtCoD,EAASG,UAAY1I,EAAQJ,GAC7B2I,EAASI,WAAaxI,EAASP,GAC/B2I,EAASK,YAAc,GAGvB,IAAMC,EAAQ,GACVN,EAAShB,WAAWsB,EAAMlI,KAAK4H,EAAShB,WACxCgB,EAASf,WAAWqB,EAAMlI,KAAK4H,EAASf,WACxCe,EAASd,WAAWoB,EAAMlI,KAAK4H,EAASd,WACxCc,EAASb,WAAWmB,EAAMlI,KAAK4H,EAASb,WACxCa,EAASZ,WAAWkB,EAAMlI,KAAK4H,EAASZ,WACxCY,EAASX,WAAWiB,EAAMlI,KAAK4H,EAASX,WAC5CW,EAASO,QAAUD,EAAMzE,OAASyE,EAAME,KAAK,KAAO,GACpDR,EAASS,QAAU9E,EAAQ2E,GAE3B,IAAMI,EAAY,GACdV,EAASV,eAAeoB,EAAUtI,KAAK4H,EAASV,eAChDU,EAAST,eAAemB,EAAUtI,KAAK4H,EAAST,eAChDS,EAASR,eAAekB,EAAUtI,KAAK4H,EAASR,eAChDQ,EAASP,eAAeiB,EAAUtI,KAAK4H,EAASP,eAChDO,EAASN,eAAegB,EAAUtI,KAAK4H,EAASN,eAChDM,EAASL,eAAee,EAAUtI,KAAK4H,EAASL,eACpDK,EAASW,YAAcD,EAAU7E,OAAS6E,EAAUF,KAAK,KAAO,GAChER,EAASY,YAAcjF,EAAQ+E,GAC3B/C,EAEFrC,EAAW,UAAD,aAAcjE,GAAIsG,EAAOtG,IAAO2I,IAAYlC,MAAK,WAEzDpG,EAAQmJ,YAIV9G,EAAW,UAAWiG,GAAUlC,MAAK,WAEnCpG,EAAQmJ,iBAkOd,gC,oJC5SC,WAAyB5G,EAAM6G,GAA/B,SAAAtI,EAAA,+EAgBE,IAAIC,SAAQ,SAACC,EAASC,GAC3BoI,KAAWC,iBACT,wBADF,uCAIE,WAAOlH,EAAOlC,GAAd,eAAAY,EAAA,6DACMsB,GAAOnB,EAAOmB,GADpB,SAEuBmH,KAAa,CAChCrJ,WAIAqC,OACAiH,aAAc,CAAC,IAAK,OARxB,OAEQC,EAFR,OAWEC,GACED,EACAL,EACA,2EAEFpI,IAhBF,2CAJF,6DAjBG,4C,sBA8CP,IAUM0I,GAAiB,SAACnH,EAAMoH,EAAUC,GACtC,IAAMC,EAAO,IAAIC,KAAK,CAACvH,GAAO,CAAE8E,KAAMuC,IAChCG,EAAM5I,OAAO6I,IAAIC,gBAAgBJ,GACvCK,GAAYH,EAAKJ,EAAUC,GAC3BO,YAAW,WACThJ,OAAO6I,IAAII,gBAAgBL,KAC1B,MAGCG,GAAc,SAAC3H,EAAMoH,GACzB,IAAM7I,EAAIuJ,SAASC,cAAc,KACjCxJ,EAAEyJ,KAAOhI,EACTzB,EAAE0J,SAAWb,EACbU,SAASI,KAAKC,YAAY5J,GAC1BA,EAAE6J,MAAQ,gBACV7J,EAAE8J,QACF9J,EAAE+J,UC5DEpL,GAAO,IAAKA,KACZqL,GAAQ,IAAMA,MAEL,SAASC,GAAT,GAA6B,IAAZ/K,EAAW,EAAXA,QACxBD,EAAUS,KAAKsF,MAAMxF,eAAeyF,QAAQ,eAC5C7F,EAAWM,KAAKsF,MAAMxF,eAAeyF,QAAQ,gBAFV,EAGXC,mBAAS,IAHE,mBAGlCgF,EAHkC,KAGzBC,EAHyB,OAIPjF,oBAAS,GAJF,mBAIlCkF,EAJkC,KAIvBC,EAJuB,KAMzChF,qBAAU,WACRjD,EAAkB,UAAW,YAAanD,EAAQJ,IAAIyG,MAAK,SAACC,GAC1D4E,EAAW5E,QAEZ,CAACtG,EAAQJ,KAyCZ,OACE,qCACE,4BACGqL,EAAQ/K,KAAI,SAACmL,GAAD,OACX,oBAEEC,WAAS,EACTC,MAAO,CACL,CACEC,KAAM,eACNC,QAAS,kBAzCI7L,EAyCoByL,EAAOzL,QAxCpDmL,GAAM,GAAI,mDAAY,CACpB,CAAES,KAAM,gBACR,CACEA,KAAM,eACNC,QAAS,WACP1H,EAAW,UAAWnE,GAAIyG,MAAK,WAC7B,IAAMqF,EAAaT,EAAQU,QAAO,SAACN,GAAD,OAAYA,EAAOzL,KAAOA,KAC5DsL,EAAWQ,UARK,IAAC9L,GA0CbgL,MAAO,CAAEgB,gBAAiB,UAAWC,MAAO,WAPlD,SAWE,cAAC,GAAD,CACExL,MAAOgL,EAAOlG,KACd7E,QAAS,WApDG,IAACV,IAqDKyL,EAAOzL,GApDnCK,EAAQU,KAAR,gBAAsBf,KAiDd,SAMGyL,EAAOrE,YAhBLqE,EAAOzL,SAqBlB,sBACA,8BACE,kBAAMF,KAAN,UACE,mBAAQ4H,KAAK,UAAUhH,QApER,WACrBL,EAAQU,KAAK,UAmEP,wCAIF,kBAAMjB,KAAN,UACE,mBAAQ4H,KAAK,UAAUhH,QAlDL,WACxB,GAAI2K,EAAQ7G,OAAQ,CAClBgH,GAAa,GACb,IAAMU,EAAQzG,GAAc4F,EAAS,IDrDpC,SAAP,sCC2DMc,CALa,CACXC,YAAahM,EAAQH,KACrBiM,SAEc,UAAM9L,EAAQH,KAAd,YAAsBM,EAASN,OACnBwG,MAAK,WAC/B+E,GAAa,WAGf,IAAM9C,KAAK,yDAAa,IAqCpB,+BAKJ,oBAAmB2D,OAAK,EAACT,KAAK,wBAASL,UAAWA,O,oBCrGxDe,IAASC,OACP,cAAC,KAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,IAAIC,OAAO,EAAMC,ULFpB,WAAiB,IAAD,EACGrG,mBAAS,IADZ,mBACtBsG,EADsB,KACZC,EADY,KAqC7B,OAlCApG,qBAAU,WACRvD,EAAc,YAAYwD,MAAK,SAACC,GAC9BkG,EAAYlG,QAEb,IA+BD,eAAClH,EAAD,CAAWE,OAAO,2BAAlB,UACE,mBAAWmN,WAAS,EAACC,cAAe,GAApC,SACGH,EAASrM,KAAI,SAACF,GAAD,OACZ,kBAAW2M,MAAX,CAGEpN,OAAQS,EAAQH,KAHlB,SAKE,cAAC,EAAD,CAAcG,QAASA,KAHlBA,EAAQJ,SAOnB,sBACA,mBAAQ0H,KAAK,UAAUhH,QA1CD,WACxB2D,EACE,2BACA,KACA,CACE,CACEuH,KAAM,gBAER,CACEA,KAAM,eACNC,QAAS,SAACxI,GACR,OAAIA,EACKX,EAAW,WAAY,CAAEzC,KAAMoD,IAASoD,MAAK,SAACzG,GACnD,IAAMgN,EAAW,sBAAOL,GAAP,CAAiB,CAAE3M,KAAIC,KAAMoD,KAC9CuJ,EAAYI,MAGP5L,QAAQE,YAKvB,UACA,KACA,CAAC,gDAkBD,kDKhDA,cAAC,IAAD,CAAOoL,UCLE,WACb,IAAMtM,EAAUS,KAAKsF,MAAMxF,eAAeyF,QAAQ,eAC5C7F,EAAWM,KAAKsF,MAAMxF,eAAeyF,QAAQ,gBACnD,OAAMhG,GAAWG,EAIf,cAACf,EAAD,CAAWE,OAAQU,EAAQH,KAAMN,OAAQY,EAASN,KAAlD,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOuM,KAAK,UAAUE,UAAWO,KACjC,cAAC,IAAD,CAAOT,KAAK,QAAQC,OAAO,EAAMC,UAAWQ,KAC5C,cAAC,IAAD,CAAOV,KAAK,YAAYE,UAAWQ,UAPhC,cAAC,IAAD,CAAUC,GAAG,cDItBzC,SAAS0C,eAAe,W","file":"static/js/main.852f9f7f.chunk.js","sourcesContent":["import React from 'react';\r\nimport { WingBlank, WhiteSpace, NavBar } from 'antd-mobile';\r\n\r\nexport default function Container({ children, navBar, header }) {\r\n  return (\r\n    <>\r\n      <NavBar mode=\"dark\">{navBar}</NavBar>\r\n      {header ? <div className=\"title\">{header}</div> : null}\r\n      <WingBlank>\r\n        <WhiteSpace />\r\n        {children}\r\n      </WingBlank>\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { List, WingBlank } from 'antd-mobile';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nconst Item = List.Item;\r\nconst templates = [\r\n  {\r\n    id: 1,\r\n    name: '钢筋混凝土柱检测记录',\r\n    enable: true,\r\n  },\r\n  {\r\n    id: 2,\r\n    name: '钢筋混凝土梁检测记录',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 3,\r\n    name: '墙钢筋及厚度检测记录',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 4,\r\n    name: '板钢筋及厚度检测记录',\r\n    enable: false,\r\n  },\r\n];\r\n\r\nfunction TemplateList({ project, history }) {\r\n  const handleItemClick = (template) => {\r\n    if (template.enable) {\r\n      sessionStorage.setItem('curProject', JSON.stringify(project));\r\n      sessionStorage.setItem('curTemplate', JSON.stringify(template));\r\n      history.push('/record');\r\n    }\r\n  };\r\n  return (\r\n    <WingBlank>\r\n      <List>\r\n        {templates.map((template) => (\r\n          <Item\r\n            disabled={!template.enable}\r\n            key={template.id}\r\n            extra={template.enable ? '' : '不可用'}\r\n            onClick={() => {\r\n              handleItemClick(template);\r\n            }}\r\n          >\r\n            {template.name}\r\n          </Item>\r\n        ))}\r\n      </List>\r\n    </WingBlank>\r\n  );\r\n}\r\n\r\nexport default withRouter(TemplateList);\r\n","let db = null;\r\n\r\nconst initDB = async () =>\r\n  await new Promise((resolve, reject) => {\r\n    const request = window.indexedDB.open('ljjDB');\r\n    request.onupgradeneeded = function (event) {\r\n      const db = event.target.result;\r\n      let objectStore = null;\r\n      if (!db.objectStoreNames.contains('projects')) {\r\n        //项目表\r\n        db.createObjectStore('projects', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n      }\r\n      if (!db.objectStoreNames.contains('columns')) {\r\n        //柱记录表\r\n        objectStore = db.createObjectStore('columns', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n        objectStore.createIndex('projectId', 'projectId', { unique: false });\r\n      }\r\n    };\r\n    request.onsuccess = function (event) {\r\n      db = event.target.result;\r\n      resolve(db);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error('数据库初始化失败！');\r\n    };\r\n  });\r\n\r\nexport const insertData = async (store, data) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction([store], 'readwrite')\r\n      .objectStore(store)\r\n      .add(data);\r\n    request.onsuccess = function (event) {\r\n      const id = event.target.result;\r\n      resolve(id);\r\n      db.close();\r\n      //   console.log(`${store}数据添加成功！`);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据添加失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//查询所有数据\r\nexport const selectAllData = async (store) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const data = [];\r\n    const request = db\r\n      .transaction(store, 'readonly')\r\n      .objectStore(store)\r\n      .openCursor();\r\n    request.onsuccess = function (event) {\r\n      const cursor = event.target.result;\r\n      if (cursor) {\r\n        const item = cursor.value;\r\n        data.push(item);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(data);\r\n        db.close();\r\n      }\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据索引条件查询数据\r\nexport const selectDataByIndex = async (store, indexName, params) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const data = [];\r\n    const range = IDBKeyRange.only(params);\r\n    const request = db\r\n      .transaction(store, 'readonly')\r\n      .objectStore(store)\r\n      .index(indexName)\r\n      .openCursor(range);\r\n    request.onsuccess = function (event) {\r\n      const cursor = event.target.result;\r\n      if (cursor) {\r\n        const item = cursor.value;\r\n        data.push(item);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(data);\r\n        db.close();\r\n      }\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据key查询数据\r\nexport const selectDataByKey = async (store, key) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db.transaction(store).objectStore(store).get(key);\r\n    request.onsuccess = function (event) {\r\n      const data = event.target.result;\r\n      resolve(data);\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//更新数据\r\nexport const updateData = async (store, value) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction(store, 'readwrite')\r\n      .objectStore(store)\r\n      .put(value);\r\n    request.onsuccess = function () {\r\n      resolve();\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据更新失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据key删除数据\r\nexport const deleteData = async (store, key) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction(store, 'readwrite')\r\n      .objectStore(store)\r\n      .delete(key);\r\n    request.onsuccess = function () {\r\n      resolve();\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据删除失败！`);\r\n    };\r\n  });\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { WhiteSpace, Modal, Button, Accordion } from 'antd-mobile';\r\nimport Container from '../components/Container';\r\nimport TemplateList from '../components/TemplateList';\r\nimport { insertData, selectAllData } from '../utils/indexDB';\r\n\r\nconst prompt = Modal.prompt;\r\n\r\nexport default function Home() {\r\n  const [projects, setProjects] = useState([]);\r\n\r\n  useEffect(() => {\r\n    selectAllData('projects').then((res) => {\r\n      setProjects(res);\r\n    });\r\n  }, []);\r\n\r\n  const handleButtonClick = () => {\r\n    prompt(\r\n      '项目名称',\r\n      null,\r\n      [\r\n        {\r\n          text: '取消',\r\n        },\r\n        {\r\n          text: '确定',\r\n          onPress: (value) => {\r\n            if (value) {\r\n              return insertData('projects', { name: value }).then((id) => {\r\n                const newProjects = [...projects, { id, name: value }];\r\n                setProjects(newProjects);\r\n              });\r\n            } else {\r\n              return Promise.reject();\r\n            }\r\n          },\r\n        },\r\n      ],\r\n      'default',\r\n      null,\r\n      ['请输入项目名称']\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Container navBar=\"项目列表\">\r\n      <Accordion accordion openAnimation={{}}>\r\n        {projects.map((project) => (\r\n          <Accordion.Panel\r\n            // style={{ marginBottom: 15 }}\r\n            key={project.id}\r\n            header={project.name}\r\n          >\r\n            <TemplateList project={project} />\r\n          </Accordion.Panel>\r\n        ))}\r\n      </Accordion>\r\n      <WhiteSpace />\r\n      <Button type=\"primary\" onClick={handleButtonClick}>\r\n        创建新项目\r\n      </Button>\r\n    </Container>\r\n  );\r\n}\r\n","//计算数组平均值并保留一位小数\r\nexport const average = (arr) => {\r\n  const reducer = (accumulator, currentValue) =>\r\n    parseInt(accumulator) + parseInt(currentValue);\r\n  return arr.length ? (arr.reduce(reducer) / arr.length).toFixed(1) : '';\r\n};\r\n\r\n//用指定的值将数字补齐到指定的长度\r\nconst fillArr = (arr, len, value) => {\r\n  if (arr.length > len) return arr;\r\n  return arr.concat(new Array(len - arr.length).fill(value));\r\n};\r\n\r\n//将数组按照指定长度分组并补齐到指定长度，然后转换成对象加上日期,设备属性\r\nconst chunk = (arr, len, key) => {\r\n  const result = [];\r\n  for (let i = 0; i < arr.length; i += len) {\r\n    result.push({\r\n      records: fillArr(arr.slice(i, i + len), len, {}),\r\n      date: key,\r\n      equip: arr[i].equip,\r\n    });\r\n  }\r\n  return result;\r\n};\r\n\r\n//按属性对object分类\r\nconst groupBy = (objectArray, property) => {\r\n  return objectArray.reduce(function (acc, obj) {\r\n    var key = obj[property];\r\n    if (!acc[key]) {\r\n      acc[key] = [];\r\n    }\r\n    acc[key].push(obj);\r\n    return acc;\r\n  }, {});\r\n};\r\n\r\n//分页\r\nconst paging = (object, len) => {\r\n  let result = [];\r\n  for (const key in object) {\r\n    result = result.concat(chunk(object[key], len, key));\r\n  }\r\n  return result;\r\n};\r\n\r\n//将记录数据处理成导出格式\r\nexport const handleRecords = (list, len) => {\r\n  //先按日期分组\r\n  const temp = groupBy(list, 'date');\r\n  //按模板每页的记录条数分页\r\n  return paging(temp, len);\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { format } from 'date-fns';\r\nimport { createForm } from 'rc-form';\r\nimport {\r\n  Button,\r\n  InputItem,\r\n  List,\r\n  DatePicker,\r\n  WhiteSpace,\r\n  Flex,\r\n  Toast,\r\n} from 'antd-mobile';\r\n\r\nimport { insertData, selectDataByKey, updateData } from '../../utils/indexDB';\r\nimport { average } from '../../utils/index';\r\n\r\nconst Item = List.Item;\r\n\r\nfunction Edit({ form, history, match }) {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n\r\n  const [record, setRecord] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const params = match.params;\r\n    if (params.id) {\r\n      //编辑\r\n      const id = params.id;\r\n      //查询记录\r\n      selectDataByKey('columns', parseInt(id)).then((res) => {\r\n        setRecord(res);\r\n      });\r\n    }\r\n  }, [match.params]);\r\n\r\n  const { getFieldProps, getFieldError } = form;\r\n\r\n  const handleClick = () => {\r\n    form.validateFields({ force: true }, (error) => {\r\n      if (!error) {\r\n        const formData = form.getFieldsValue();\r\n        formData.date = format(formData.date, 'yyyy-MM-dd');\r\n        formData.projectId = project.id;\r\n        formData.templateId = template.id;\r\n        formData.section_s_a = '';\r\n        //计算平均值\r\n\r\n        const space = [];\r\n        if (formData.space_m_1) space.push(formData.space_m_1);\r\n        if (formData.space_m_2) space.push(formData.space_m_2);\r\n        if (formData.space_m_3) space.push(formData.space_m_3);\r\n        if (formData.space_m_4) space.push(formData.space_m_4);\r\n        if (formData.space_m_5) space.push(formData.space_m_5);\r\n        if (formData.space_m_6) space.push(formData.space_m_6);\r\n        formData.space_m = space.length ? space.join(',') : '';\r\n        formData.space_a = average(space);\r\n\r\n        const space_non = [];\r\n        if (formData.space_non_m_1) space_non.push(formData.space_non_m_1);\r\n        if (formData.space_non_m_2) space_non.push(formData.space_non_m_2);\r\n        if (formData.space_non_m_3) space_non.push(formData.space_non_m_3);\r\n        if (formData.space_non_m_4) space_non.push(formData.space_non_m_4);\r\n        if (formData.space_non_m_5) space_non.push(formData.space_non_m_5);\r\n        if (formData.space_non_m_6) space_non.push(formData.space_non_m_6);\r\n        formData.space_non_m = space_non.length ? space_non.join(',') : '';\r\n        formData.space_non_a = average(space_non);\r\n        if (record) {\r\n          //编辑\r\n          updateData('columns', { id: record.id, ...formData }).then(() => {\r\n            // history.replace('/record');\r\n            history.goBack();\r\n          });\r\n        } else {\r\n          //新增\r\n          insertData('columns', formData).then(() => {\r\n            // history.replace('/record');\r\n            history.goBack();\r\n          });\r\n        }\r\n      } else {\r\n        Toast.fail('必填项未填写！', 2);\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <List>\r\n        <DatePicker\r\n          mode=\"date\"\r\n          title=\"选择日期\"\r\n          {...getFieldProps('date', {\r\n            initialValue: record ? new Date(record.date) : new Date(),\r\n          })}\r\n        >\r\n          <Item>检测时间</Item>\r\n        </DatePicker>\r\n        <InputItem\r\n          labelNumber={7}\r\n          error={!!getFieldError('equip')}\r\n          {...getFieldProps('equip', {\r\n            initialValue: record ? record.equip : '',\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          检测设备及名称\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('position')}\r\n          {...getFieldProps('position', {\r\n            initialValue: record ? record.position : '',\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          柱位置\r\n        </InputItem>\r\n      </List>\r\n      <div className=\"sub-title\">截面尺寸（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_1', {\r\n              initialValue: record ? record.section_s_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_2', {\r\n              initialValue: record ? record.section_s_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_3', {\r\n              initialValue: record ? record.section_s_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <div className=\"sub-title\">柱纵筋实测分布（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"柱纵筋实测分布\"\r\n            {...getFieldProps('bar', {\r\n              initialValue: record ? record.bar : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item />\r\n      </Flex>\r\n      <div className=\"sub-title\">加密区箍筋间距（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_1', {\r\n              initialValue: record ? record.space_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_2', {\r\n              initialValue: record ? record.space_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_3', {\r\n              initialValue: record ? record.space_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_4', {\r\n              initialValue: record ? record.space_m_4 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_5', {\r\n              initialValue: record ? record.space_m_5 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_6', {\r\n              initialValue: record ? record.space_m_6 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <div className=\"sub-title\">非加密区实测箍筋间距（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_1', {\r\n              initialValue: record ? record.space_non_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_2', {\r\n              initialValue: record ? record.space_non_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_3', {\r\n              initialValue: record ? record.space_non_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_4', {\r\n              initialValue: record ? record.space_non_m_4 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_5', {\r\n              initialValue: record ? record.space_non_m_5 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_6', {\r\n              initialValue: record ? record.space_non_m_6 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <div className=\"sub-title\">设计箍筋间距（mm）</div>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"设计箍筋间距\"\r\n            {...getFieldProps('space_d', {\r\n              initialValue: record ? record.space_d : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <div className=\"sub-title\">加密区长度（mm）</div>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"加密区长度\"\r\n            {...getFieldProps('length', {\r\n              initialValue: record ? record.length : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      {/* <Button type=\"primary\" onClick={handleClick}>\r\n        导出\r\n      </Button> */}\r\n      <Button type=\"primary\" onClick={handleClick}>\r\n        保存\r\n      </Button>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default createForm()(Edit);\r\n","import createReport from 'docx-templates';\r\nimport JSZipUtils from 'jszip-utils';\r\n\r\nexport async function genReport(data, reportName) {\r\n  //上传模版\r\n  // const template = await readFileIntoArrayBuffer(file);\r\n  // const report = await createReport({\r\n  //   template,\r\n  //   data: {\r\n  //     name: \"John\",\r\n  //     surname: \"Appleseed\",\r\n  //   },\r\n  //   cmdDelimiter: [\"{\", \"}\"],\r\n  // });\r\n  // saveDataToFile(\r\n  //   report,\r\n  //   \"report.docx\",\r\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n  // );\r\n  return new Promise((resolve, reject) => {\r\n    JSZipUtils.getBinaryContent(\r\n      './templates/F-05.docx',\r\n      // \"./templates/template.docx\",\r\n      // \"./templates/myTemplate.docx\",\r\n      async (error, template) => {\r\n        if (error) reject(error);\r\n        const report = await createReport({\r\n          template,\r\n          // data: {\r\n          //   columns: [{}, {}],\r\n          // },\r\n          data,\r\n          cmdDelimiter: ['{', '}'],\r\n        });\r\n        // Save report\r\n        saveDataToFile(\r\n          report,\r\n          reportName,\r\n          'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n        );\r\n        resolve();\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// ==============================================\r\n// Helpers\r\n// ==============================================\r\nconst readFileIntoArrayBuffer = async (fd) =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onerror = reject;\r\n    reader.onload = () => {\r\n      resolve(reader.result);\r\n    };\r\n    reader.readAsArrayBuffer(fd);\r\n  });\r\n\r\nconst saveDataToFile = (data, fileName, mimeType) => {\r\n  const blob = new Blob([data], { type: mimeType });\r\n  const url = window.URL.createObjectURL(blob);\r\n  downloadURL(url, fileName, mimeType);\r\n  setTimeout(() => {\r\n    window.URL.revokeObjectURL(url);\r\n  }, 1000);\r\n};\r\n\r\nconst downloadURL = (data, fileName) => {\r\n  const a = document.createElement('a');\r\n  a.href = data;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.style = 'display: none';\r\n  a.click();\r\n  a.remove();\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  List,\r\n  Button,\r\n  WhiteSpace,\r\n  Flex,\r\n  Toast,\r\n  ActivityIndicator,\r\n  SwipeAction,\r\n  Modal,\r\n} from 'antd-mobile';\r\nimport { selectDataByIndex, deleteData } from '../../utils/indexDB';\r\nimport { genReport } from '../../utils/docx';\r\nimport { handleRecords } from '../../utils/index';\r\n\r\nconst Item = List.Item;\r\nconst alert = Modal.alert;\r\n\r\nexport default function Rlist({ history }) {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n  const [columns, setColumns] = useState([]);\r\n  const [animating, setAnimating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    selectDataByIndex('columns', 'projectId', project.id).then((res) => {\r\n      setColumns(res);\r\n    });\r\n  }, [project.id]);\r\n\r\n  const handleAddClick = () => {\r\n    history.push('/edit');\r\n  };\r\n\r\n  const handleEditClick = (id) => {\r\n    history.push(`/edit/${id}`);\r\n  };\r\n\r\n  const handleDeleteClick = (id) => {\r\n    alert('', '确定删除该记录？', [\r\n      { text: '取消' },\r\n      {\r\n        text: '确定',\r\n        onPress: () => {\r\n          deleteData('columns', id).then(() => {\r\n            const newColumns = columns.filter((column) => column.id !== id);\r\n            setColumns(newColumns);\r\n          });\r\n        },\r\n      },\r\n    ]);\r\n  };\r\n\r\n  const handleExportClick = () => {\r\n    if (columns.length) {\r\n      setAnimating(true);\r\n      const pages = handleRecords(columns, 4);\r\n      const data = {\r\n        projectName: project.name,\r\n        pages,\r\n      };\r\n      const reportName = `${project.name}-${template.name}`;\r\n      genReport(data, reportName).then(() => {\r\n        setAnimating(false);\r\n      });\r\n    } else {\r\n      Toast.fail('没有要导出的记录！', 2);\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      <List>\r\n        {columns.map((column) => (\r\n          <SwipeAction\r\n            key={column.id}\r\n            autoClose\r\n            right={[\r\n              {\r\n                text: '删除',\r\n                onPress: () => handleDeleteClick(column.id),\r\n                style: { backgroundColor: '#F4333C', color: 'white' },\r\n              },\r\n            ]}\r\n          >\r\n            <Item\r\n              extra={column.date}\r\n              onClick={() => {\r\n                handleEditClick(column.id);\r\n              }}\r\n            >\r\n              {column.position}\r\n            </Item>\r\n          </SwipeAction>\r\n        ))}\r\n      </List>\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <Button type=\"primary\" onClick={handleAddClick}>\r\n            添加记录\r\n          </Button>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <Button type=\"default\" onClick={handleExportClick}>\r\n            导出\r\n          </Button>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <ActivityIndicator toast text=\"导出中...\" animating={animating} />\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Home from './containers/Home';\r\nimport Main from './containers/Main';\r\nimport { HashRouter, Switch, Route } from 'react-router-dom';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <HashRouter>\r\n    <Switch>\r\n      <Route path=\"/\" exact={true} component={Home} />\r\n      <Route component={Main} />\r\n    </Switch>\r\n  </HashRouter>,\r\n  document.getElementById('root')\r\n);\r\n","import React from 'react';\r\nimport { Redirect, Switch, Route } from 'react-router-dom';\r\nimport Container from '../components/Container';\r\nimport Edit from './record/Edit';\r\nimport List from './record/List';\r\n\r\nexport default function Main() {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n  if (!(project && template)) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n  return (\r\n    <Container navBar={project.name} header={template.name}>\r\n      <Switch>\r\n        <Route path=\"/record\" component={List} />\r\n        <Route path=\"/edit\" exact={true} component={Edit} />\r\n        <Route path=\"/edit/:id\" component={Edit} />\r\n      </Switch>\r\n    </Container>\r\n  );\r\n}\r\n"],"sourceRoot":""}