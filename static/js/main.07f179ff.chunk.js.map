{"version":3,"sources":["components/Container.js","components/TemplateList.js","utils/indexDB.js","containers/Home.js","utils/index.js","containers/record/Edit.js","utils/docx.js","containers/Records.js","index.js","containers/Main.js"],"names":["Container","children","navBar","header","mode","className","Item","templates","id","name","store","enable","withRouter","project","history","map","template","disabled","extra","onClick","sessionStorage","setItem","JSON","stringify","push","handleItemClick","db","initDB","a","Promise","resolve","reject","request","window","indexedDB","open","onupgradeneeded","event","target","result","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","createIndex","unique","onsuccess","onerror","console","error","insertData","data","transaction","objectStore","add","close","selectAllData","openCursor","cursor","item","value","continue","selectDataByIndex","indexName","params","range","IDBKeyRange","only","index","selectDataByKey","key","get","updateData","put","deleteData","delete","prompt","average","arr","length","reduce","accumulator","currentValue","parseInt","toFixed","fillArr","len","concat","Array","fill","chunk","i","records","slice","date","equip","createForm","form","match","parse","getItem","useState","record","setRecord","useEffect","then","res","getFieldProps","getFieldError","title","initialValue","Date","labelNumber","rules","required","message","position","placeholder","section_s_m_1","section_s_m_2","section_s_m_3","bar","type","space_m_1","space_m_2","space_m_3","space_m_4","space_m_5","space_m_6","space_non_m_1","space_non_m_2","space_non_m_3","space_non_m_4","space_non_m_5","space_non_m_6","space_d","validateFields","force","fail","formData","getFieldsValue","format","projectId","templateId","section_s_a","space","space_m","join","space_a","space_non","space_non_m","space_non_a","goBack","reportName","JSZipUtils","getBinaryContent","createReport","cmdDelimiter","report","saveDataToFile","fileName","mimeType","blob","Blob","url","URL","createObjectURL","downloadURL","setTimeout","revokeObjectURL","document","createElement","href","download","body","appendChild","style","click","remove","alert","Records","property","setRecords","animating","setAnimating","groupRecords","acc","obj","sort","b","Object","keys","renderHeader","autoClose","right","text","onPress","newRecords","filter","backgroundColor","color","projectName","genReport","pages","object","paging","toast","ReactDOM","render","path","exact","component","projects","setProjects","accordion","openAnimation","Panel","newProjects","Edit","to","getElementById"],"mappings":"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","file":"static/js/main.07f179ff.chunk.js","sourcesContent":["import React from 'react';\r\nimport { WingBlank, WhiteSpace, NavBar } from 'antd-mobile';\r\n\r\nexport default function Container({ children, navBar, header }) {\r\n  return (\r\n    <>\r\n      <NavBar mode=\"dark\">{navBar}</NavBar>\r\n      {header ? <div className=\"title\">{header}</div> : null}\r\n      <WingBlank>\r\n        <WhiteSpace />\r\n        {children}\r\n      </WingBlank>\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { List, WingBlank } from 'antd-mobile';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nconst Item = List.Item;\r\nconst templates = [\r\n  {\r\n    id: 1,\r\n    name: '钢筋混凝土柱检测记录',\r\n    store: 'columns',\r\n    enable: true,\r\n  },\r\n  {\r\n    id: 2,\r\n    name: '钢筋混凝土梁检测记录',\r\n    store: 'beams',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 3,\r\n    name: '墙钢筋及厚度检测记录',\r\n    store: 'walls',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 4,\r\n    name: '板钢筋及厚度检测记录',\r\n    store: 'floors',\r\n    enable: false,\r\n  },\r\n];\r\n\r\nfunction TemplateList({ project, history }) {\r\n  const handleItemClick = (template) => {\r\n    if (template.enable) {\r\n      sessionStorage.setItem('curProject', JSON.stringify(project));\r\n      sessionStorage.setItem('curTemplate', JSON.stringify(template));\r\n      history.push('/records');\r\n    }\r\n  };\r\n  return (\r\n    <WingBlank>\r\n      <List>\r\n        {templates.map((template) => (\r\n          <Item\r\n            disabled={!template.enable}\r\n            key={template.id}\r\n            extra={template.enable ? '' : '不可用'}\r\n            onClick={() => {\r\n              handleItemClick(template);\r\n            }}\r\n          >\r\n            {template.name}\r\n          </Item>\r\n        ))}\r\n      </List>\r\n    </WingBlank>\r\n  );\r\n}\r\n\r\nexport default withRouter(TemplateList);\r\n","let db = null;\r\n\r\nconst initDB = async () =>\r\n  await new Promise((resolve, reject) => {\r\n    const request = window.indexedDB.open('ljjDB', 1);\r\n    request.onupgradeneeded = function (event) {\r\n      const db = event.target.result;\r\n      let objectStore = null;\r\n      if (!db.objectStoreNames.contains('projects')) {\r\n        //项目表\r\n        db.createObjectStore('projects', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n      }\r\n      if (!db.objectStoreNames.contains('columns')) {\r\n        //柱记录表\r\n        objectStore = db.createObjectStore('columns', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n        objectStore.createIndex('projectId', 'projectId', { unique: false });\r\n      }\r\n      if (!db.objectStoreNames.contains('beams')) {\r\n        //梁记录表\r\n        objectStore = db.createObjectStore('beams', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n        objectStore.createIndex('projectId', 'projectId', { unique: false });\r\n      }\r\n      if (!db.objectStoreNames.contains('walls')) {\r\n        //墙记录表\r\n        objectStore = db.createObjectStore('walls', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n        objectStore.createIndex('projectId', 'projectId', { unique: false });\r\n      }\r\n      if (!db.objectStoreNames.contains('floors')) {\r\n        //板记录表\r\n        objectStore = db.createObjectStore('floors', {\r\n          keyPath: 'id',\r\n          autoIncrement: true,\r\n        });\r\n        objectStore.createIndex('projectId', 'projectId', { unique: false });\r\n      }\r\n    };\r\n    request.onsuccess = function (event) {\r\n      db = event.target.result;\r\n      resolve(db);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error('数据库初始化失败！');\r\n    };\r\n  });\r\n\r\nexport const insertData = async (store, data) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction([store], 'readwrite')\r\n      .objectStore(store)\r\n      .add(data);\r\n    request.onsuccess = function (event) {\r\n      const id = event.target.result;\r\n      resolve(id);\r\n      db.close();\r\n      //   console.log(`${store}数据添加成功！`);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据添加失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//查询所有数据\r\nexport const selectAllData = async (store) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const data = [];\r\n    const request = db\r\n      .transaction(store, 'readonly')\r\n      .objectStore(store)\r\n      .openCursor();\r\n    request.onsuccess = function (event) {\r\n      const cursor = event.target.result;\r\n      if (cursor) {\r\n        const item = cursor.value;\r\n        data.push(item);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(data);\r\n        db.close();\r\n      }\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据索引条件查询数据\r\nexport const selectDataByIndex = async (store, indexName, params) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const data = [];\r\n    const range = IDBKeyRange.only(params);\r\n    const request = db\r\n      .transaction(store, 'readonly')\r\n      .objectStore(store)\r\n      .index(indexName)\r\n      .openCursor(range);\r\n    request.onsuccess = function (event) {\r\n      const cursor = event.target.result;\r\n      if (cursor) {\r\n        const item = cursor.value;\r\n        data.push(item);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(data);\r\n        db.close();\r\n      }\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据key查询数据\r\nexport const selectDataByKey = async (store, key) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db.transaction(store).objectStore(store).get(key);\r\n    request.onsuccess = function (event) {\r\n      const data = event.target.result;\r\n      resolve(data);\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//更新数据\r\nexport const updateData = async (store, value) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction(store, 'readwrite')\r\n      .objectStore(store)\r\n      .put(value);\r\n    request.onsuccess = function () {\r\n      resolve();\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据更新失败！`);\r\n    };\r\n  });\r\n};\r\n\r\n//根据key删除数据\r\nexport const deleteData = async (store, key) => {\r\n  await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction(store, 'readwrite')\r\n      .objectStore(store)\r\n      .delete(key);\r\n    request.onsuccess = function () {\r\n      resolve();\r\n      db.close();\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据删除失败！`);\r\n    };\r\n  });\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { WhiteSpace, Modal, Button, Accordion } from 'antd-mobile';\r\nimport Container from '../components/Container';\r\nimport TemplateList from '../components/TemplateList';\r\nimport { insertData, selectAllData } from '../utils/indexDB';\r\n\r\nconst prompt = Modal.prompt;\r\n\r\nexport default function Home() {\r\n  const [projects, setProjects] = useState([]);\r\n\r\n  useEffect(() => {\r\n    selectAllData('projects').then((res) => {\r\n      setProjects(res);\r\n    });\r\n  }, []);\r\n\r\n  const handleButtonClick = () => {\r\n    prompt(\r\n      '项目名称',\r\n      null,\r\n      [\r\n        {\r\n          text: '取消',\r\n        },\r\n        {\r\n          text: '确定',\r\n          onPress: (value) => {\r\n            if (value) {\r\n              return insertData('projects', { name: value }).then((id) => {\r\n                const newProjects = [...projects, { id, name: value }];\r\n                setProjects(newProjects);\r\n              });\r\n            } else {\r\n              return Promise.reject();\r\n            }\r\n          },\r\n        },\r\n      ],\r\n      'default',\r\n      null,\r\n      ['请输入项目名称']\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Container navBar=\"项目列表\">\r\n      <Accordion accordion openAnimation={{}}>\r\n        {projects.map((project) => (\r\n          <Accordion.Panel\r\n            // style={{ marginBottom: 15 }}\r\n            key={project.id}\r\n            header={project.name}\r\n          >\r\n            <TemplateList project={project} />\r\n          </Accordion.Panel>\r\n        ))}\r\n      </Accordion>\r\n      <WhiteSpace />\r\n      <Button type=\"primary\" onClick={handleButtonClick}>\r\n        创建新项目\r\n      </Button>\r\n    </Container>\r\n  );\r\n}\r\n","//计算数组平均值并保留一位小数\r\nexport const average = (arr) => {\r\n  const reducer = (accumulator, currentValue) =>\r\n    parseInt(accumulator) + parseInt(currentValue);\r\n  return arr.length ? (arr.reduce(reducer) / arr.length).toFixed(1) : '';\r\n};\r\n\r\n//用指定的值将数字补齐到指定的长度\r\nconst fillArr = (arr, len, value) => {\r\n  if (arr.length > len) return arr;\r\n  return arr.concat(new Array(len - arr.length).fill(value));\r\n};\r\n\r\n//将数组按照指定长度分组并补齐到指定长度，然后转换成对象加上日期,设备属性\r\nconst chunk = (arr, len, key) => {\r\n  const result = [];\r\n  for (let i = 0; i < arr.length; i += len) {\r\n    result.push({\r\n      records: fillArr(arr.slice(i, i + len), len, {}),\r\n      date: key,\r\n      equip: arr[i].equip,\r\n    });\r\n  }\r\n  return result;\r\n};\r\n\r\n//按属性对object分类\r\nexport const groupBy = (objectArray, property) => {\r\n  return objectArray.reduce(function (acc, obj) {\r\n    var key = obj[property];\r\n    if (!acc[key]) {\r\n      acc[key] = [];\r\n    }\r\n    acc[key].push(obj);\r\n    return acc;\r\n  }, {});\r\n};\r\n\r\n//分页\r\nexport const paging = (object, len) => {\r\n  let result = [];\r\n  for (const key in object) {\r\n    result = result.concat(chunk(object[key], len, key));\r\n  }\r\n  return result;\r\n};\r\n\r\n// //将记录数据处理成导出格式\r\n// export const handleRecords = (list, len) => {\r\n//   //先按日期分组\r\n//   const temp = groupBy(list, 'date');\r\n//   //按模板每页的记录条数分页\r\n//   return paging(temp, len);\r\n// };\r\n","import React, { useState, useEffect } from 'react';\r\nimport { format } from 'date-fns';\r\nimport { createForm } from 'rc-form';\r\nimport {\r\n  Button,\r\n  InputItem,\r\n  List,\r\n  DatePicker,\r\n  WhiteSpace,\r\n  Flex,\r\n  Toast,\r\n} from 'antd-mobile';\r\n\r\nimport { insertData, selectDataByKey, updateData } from '../../utils/indexDB';\r\nimport { average } from '../../utils/index';\r\n\r\nconst Item = List.Item;\r\n\r\nfunction Edit({ form, history, match }) {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n\r\n  const [record, setRecord] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const params = match.params;\r\n    if (params.id) {\r\n      //编辑\r\n      const id = params.id;\r\n      //查询记录\r\n      selectDataByKey('columns', parseInt(id)).then((res) => {\r\n        setRecord(res);\r\n      });\r\n    }\r\n  }, [match.params]);\r\n\r\n  const { getFieldProps, getFieldError } = form;\r\n\r\n  const handleClick = () => {\r\n    form.validateFields({ force: true }, (error) => {\r\n      if (!error) {\r\n        const formData = form.getFieldsValue();\r\n        formData.date = format(formData.date, 'yyyy-MM-dd');\r\n        formData.projectId = project.id;\r\n        formData.templateId = template.id;\r\n        formData.section_s_a = '';\r\n        //计算平均值\r\n\r\n        const space = [];\r\n        if (formData.space_m_1) space.push(formData.space_m_1);\r\n        if (formData.space_m_2) space.push(formData.space_m_2);\r\n        if (formData.space_m_3) space.push(formData.space_m_3);\r\n        if (formData.space_m_4) space.push(formData.space_m_4);\r\n        if (formData.space_m_5) space.push(formData.space_m_5);\r\n        if (formData.space_m_6) space.push(formData.space_m_6);\r\n        formData.space_m = space.length ? space.join(',') : '';\r\n        formData.space_a = average(space);\r\n\r\n        const space_non = [];\r\n        if (formData.space_non_m_1) space_non.push(formData.space_non_m_1);\r\n        if (formData.space_non_m_2) space_non.push(formData.space_non_m_2);\r\n        if (formData.space_non_m_3) space_non.push(formData.space_non_m_3);\r\n        if (formData.space_non_m_4) space_non.push(formData.space_non_m_4);\r\n        if (formData.space_non_m_5) space_non.push(formData.space_non_m_5);\r\n        if (formData.space_non_m_6) space_non.push(formData.space_non_m_6);\r\n        formData.space_non_m = space_non.length ? space_non.join(',') : '';\r\n        formData.space_non_a = average(space_non);\r\n        if (record) {\r\n          //编辑\r\n          updateData('columns', { id: record.id, ...formData }).then(() => {\r\n            // history.replace('/record');\r\n            history.goBack();\r\n          });\r\n        } else {\r\n          //新增\r\n          insertData('columns', formData).then(() => {\r\n            // history.replace('/record');\r\n            history.goBack();\r\n          });\r\n        }\r\n      } else {\r\n        Toast.fail('必填项未填写！', 2);\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <List>\r\n        <DatePicker\r\n          mode=\"date\"\r\n          title=\"选择日期\"\r\n          {...getFieldProps('date', {\r\n            initialValue: record ? new Date(record.date) : new Date(),\r\n          })}\r\n        >\r\n          <Item>检测时间</Item>\r\n        </DatePicker>\r\n        <InputItem\r\n          labelNumber={7}\r\n          error={!!getFieldError('equip')}\r\n          {...getFieldProps('equip', {\r\n            initialValue: record ? record.equip : '',\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          检测设备及名称\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('position')}\r\n          {...getFieldProps('position', {\r\n            initialValue: record ? record.position : '',\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          柱位置\r\n        </InputItem>\r\n      </List>\r\n      <div className=\"sub-title\">截面尺寸（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_1', {\r\n              initialValue: record ? record.section_s_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_2', {\r\n              initialValue: record ? record.section_s_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('section_s_m_3', {\r\n              initialValue: record ? record.section_s_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <div className=\"sub-title\">柱纵筋实测分布（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            placeholder=\"柱纵筋实测分布\"\r\n            {...getFieldProps('bar', {\r\n              initialValue: record ? record.bar : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item />\r\n      </Flex>\r\n      <div className=\"sub-title\">加密区箍筋间距（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_1', {\r\n              initialValue: record ? record.space_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_2', {\r\n              initialValue: record ? record.space_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_3', {\r\n              initialValue: record ? record.space_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_4', {\r\n              initialValue: record ? record.space_m_4 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_5', {\r\n              initialValue: record ? record.space_m_5 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_m_6', {\r\n              initialValue: record ? record.space_m_6 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <div className=\"sub-title\">非加密区实测箍筋间距（mm）</div>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_1', {\r\n              initialValue: record ? record.space_non_m_1 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_2', {\r\n              initialValue: record ? record.space_non_m_2 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_3', {\r\n              initialValue: record ? record.space_non_m_3 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_4', {\r\n              initialValue: record ? record.space_non_m_4 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_5', {\r\n              initialValue: record ? record.space_non_m_5 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"实测值\"\r\n            {...getFieldProps('space_non_m_6', {\r\n              initialValue: record ? record.space_non_m_6 : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <Flex>\r\n        <Flex.Item>\r\n          <div className=\"sub-title\">设计箍筋间距（mm）</div>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"设计箍筋间距\"\r\n            {...getFieldProps('space_d', {\r\n              initialValue: record ? record.space_d : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <div className=\"sub-title\">加密区长度（mm）</div>\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"加密区长度\"\r\n            {...getFieldProps('length', {\r\n              initialValue: record ? record.length : '',\r\n            })}\r\n          ></InputItem>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <WhiteSpace />\r\n      {/* <Button type=\"primary\" onClick={handleClick}>\r\n        导出\r\n      </Button> */}\r\n      <Button type=\"primary\" onClick={handleClick}>\r\n        保存\r\n      </Button>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default createForm()(Edit);\r\n","import createReport from 'docx-templates';\r\nimport JSZipUtils from 'jszip-utils';\r\n\r\nexport async function genReport(data, reportName, store) {\r\n  //上传模版\r\n  // const template = await readFileIntoArrayBuffer(file);\r\n  // const report = await createReport({\r\n  //   template,\r\n  //   data: {\r\n  //     name: \"John\",\r\n  //     surname: \"Appleseed\",\r\n  //   },\r\n  //   cmdDelimiter: [\"{\", \"}\"],\r\n  // });\r\n  // saveDataToFile(\r\n  //   report,\r\n  //   \"report.docx\",\r\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n  // );\r\n  return new Promise((resolve, reject) => {\r\n    JSZipUtils.getBinaryContent(\r\n      `./templates/${store}.docx`,\r\n      // \"./templates/template.docx\",\r\n      // \"./templates/myTemplate.docx\",\r\n      async (error, template) => {\r\n        if (error) reject(error);\r\n        const report = await createReport({\r\n          template,\r\n          // data: {\r\n          //   columns: [{}, {}],\r\n          // },\r\n          data,\r\n          cmdDelimiter: ['{', '}'],\r\n        });\r\n        // Save report\r\n        saveDataToFile(\r\n          report,\r\n          reportName,\r\n          'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n        );\r\n        resolve();\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// ==============================================\r\n// Helpers\r\n// ==============================================\r\nconst readFileIntoArrayBuffer = async (fd) =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onerror = reject;\r\n    reader.onload = () => {\r\n      resolve(reader.result);\r\n    };\r\n    reader.readAsArrayBuffer(fd);\r\n  });\r\n\r\nconst saveDataToFile = (data, fileName, mimeType) => {\r\n  const blob = new Blob([data], { type: mimeType });\r\n  const url = window.URL.createObjectURL(blob);\r\n  downloadURL(url, fileName, mimeType);\r\n  setTimeout(() => {\r\n    window.URL.revokeObjectURL(url);\r\n  }, 1000);\r\n};\r\n\r\nconst downloadURL = (data, fileName) => {\r\n  const a = document.createElement('a');\r\n  a.href = data;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.style = 'display: none';\r\n  a.click();\r\n  a.remove();\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  List,\r\n  Button,\r\n  WhiteSpace,\r\n  Flex,\r\n  Toast,\r\n  ActivityIndicator,\r\n  SwipeAction,\r\n  Modal,\r\n} from 'antd-mobile';\r\nimport { selectDataByIndex, deleteData } from '../utils/indexDB';\r\nimport { genReport } from '../utils/docx';\r\nimport { groupBy, paging } from '../utils/index';\r\n\r\nconst Item = List.Item;\r\nconst alert = Modal.alert;\r\n\r\nexport default function Records({ history }) {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n  const [records, setRecords] = useState([]);\r\n  const [animating, setAnimating] = useState(false);\r\n  const groupRecords = groupBy(records, 'date');\r\n  useEffect(() => {\r\n    selectDataByIndex(template.store, 'projectId', project.id).then((res) => {\r\n      const records = res.sort((a, b) => (a.date < b.date ? -1 : 0));\r\n      setRecords(records);\r\n    });\r\n  }, [project.id, template.store]);\r\n\r\n  const handleAddClick = () => {\r\n    history.push('/edit');\r\n  };\r\n\r\n  const handleEditClick = (id) => {\r\n    history.push(`/edit/${id}`);\r\n  };\r\n\r\n  const handleDeleteClick = (id) => {\r\n    alert('', '确定删除该记录？', [\r\n      { text: '取消' },\r\n      {\r\n        text: '确定',\r\n        onPress: () => {\r\n          deleteData('columns', id).then(() => {\r\n            const newRecords = records.filter((record) => record.id !== id);\r\n            setRecords(newRecords);\r\n          });\r\n        },\r\n      },\r\n    ]);\r\n  };\r\n\r\n  const handleExportClick = () => {\r\n    if (records.length) {\r\n      setAnimating(true);\r\n      const projectName = project.name;\r\n      const pages = paging(groupRecords, 4);\r\n      const data = {\r\n        projectName,\r\n        pages,\r\n      };\r\n      const reportName = `${projectName}-${template.name}`;\r\n      genReport(data, reportName, template.store).then(() => {\r\n        setAnimating(false);\r\n      });\r\n    } else {\r\n      Toast.fail('没有要导出的记录！', 2);\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      {Object.keys(groupRecords).map((date) => (\r\n        <List key={date} renderHeader={() => date}>\r\n          {groupRecords[date].map((record) => (\r\n            <SwipeAction\r\n              key={record.id}\r\n              autoClose\r\n              right={[\r\n                {\r\n                  text: '删除',\r\n                  onPress: () => handleDeleteClick(record.id),\r\n                  style: { backgroundColor: '#F4333C', color: 'white' },\r\n                },\r\n              ]}\r\n            >\r\n              <Item\r\n                onClick={() => {\r\n                  handleEditClick(record.id);\r\n                }}\r\n              >\r\n                {record.position}\r\n              </Item>\r\n            </SwipeAction>\r\n          ))}\r\n        </List>\r\n      ))}\r\n\r\n      {/* <List>\r\n        {records.map((record) => (\r\n          <SwipeAction\r\n            key={record.id}\r\n            autoClose\r\n            right={[\r\n              {\r\n                text: '删除',\r\n                onPress: () => handleDeleteClick(record.id),\r\n                style: { backgroundColor: '#F4333C', color: 'white' },\r\n              },\r\n            ]}\r\n          >\r\n            <Item\r\n              extra={record.date}\r\n              onClick={() => {\r\n                handleEditClick(record.id);\r\n              }}\r\n            >\r\n              {record.position}\r\n            </Item>\r\n          </SwipeAction>\r\n        ))}\r\n      </List> */}\r\n\r\n      <WhiteSpace />\r\n      <Flex>\r\n        <Flex.Item>\r\n          <Button type=\"primary\" onClick={handleAddClick}>\r\n            添加记录\r\n          </Button>\r\n        </Flex.Item>\r\n        <Flex.Item>\r\n          <Button type=\"default\" onClick={handleExportClick}>\r\n            导出\r\n          </Button>\r\n        </Flex.Item>\r\n      </Flex>\r\n      <ActivityIndicator toast text=\"导出中...\" animating={animating} />\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Home from './containers/Home';\r\nimport Main from './containers/Main';\r\nimport { HashRouter, Switch, Route } from 'react-router-dom';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <HashRouter>\r\n    <Switch>\r\n      <Route path=\"/\" exact={true} component={Home} />\r\n      <Route component={Main} />\r\n    </Switch>\r\n  </HashRouter>,\r\n  document.getElementById('root')\r\n);\r\n","import React from 'react';\r\nimport { Redirect, Switch, Route } from 'react-router-dom';\r\nimport Container from '../components/Container';\r\nimport Edit from './record/Edit';\r\nimport Records from './Records';\r\n\r\nexport default function Main() {\r\n  const project = JSON.parse(sessionStorage.getItem('curProject'));\r\n  const template = JSON.parse(sessionStorage.getItem('curTemplate'));\r\n  if (!(project && template)) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n  return (\r\n    <Container navBar={project.name} header={template.name}>\r\n      <Switch>\r\n        <Route path=\"/records\" component={Records} />\r\n        <Route path=\"/edit\" exact={true} component={Edit} />\r\n        <Route path=\"/edit/:id\" component={Edit} />\r\n      </Switch>\r\n    </Container>\r\n  );\r\n}\r\n"],"sourceRoot":""}