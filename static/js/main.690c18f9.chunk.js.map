{"version":3,"sources":["components/Container.js","utils/indexDB.js","containers/record/Add.js","utils/index.js","containers/record/List.js","components/TemplateList.js","containers/Main.js","index.js","containers/record/Record.js"],"names":["Container","children","navBar","header","mode","className","db","initDB","a","Promise","resolve","reject","request","window","indexedDB","open","onupgradeneeded","event","target","result","objectStoreNames","contains","createObjectStore","autoIncrement","createIndex","unique","onsuccess","onerror","console","error","insertData","store","data","transaction","objectStore","add","id","close","selectAllData","openCursor","cursor","item","primaryKey","value","push","continue","selectDataByIndex","indexName","params","range","IDBKeyRange","only","index","Item","createForm","form","history","project","JSON","parse","sessionStorage","getItem","template","getFieldProps","getFieldError","name","title","initialValue","Date","labelNumber","rules","required","message","placeholder","type","onClick","validateFields","force","fail","formData","getFieldsValue","date","format","projectId","templateId","section_s_a","reducer","accumulator","currentValue","parseInt","space","space_m_1","space_m_2","space_m_3","space_m_4","space_m_5","space_m_6","space_m","length","join","space_a","reduce","space_non","space_non_m_1","space_non_m_2","space_non_m_3","space_non_m_4","space_non_m_5","space_non_m_6","space_non_m","space_non_a","then","replace","log","JSZipUtils","getBinaryContent","createReport","cmdDelimiter","report","saveDataToFile","fileName","mimeType","blob","Blob","url","URL","createObjectURL","downloadURL","setTimeout","revokeObjectURL","document","createElement","href","download","body","appendChild","style","click","remove","templates","enable","withRouter","map","disabled","extra","setItem","stringify","handleItemClick","prompt","ReactDOM","render","path","component","Add","useState","columns","setColumns","useEffect","res","column","position","fullColumns","concat","Array","fill","genReport","projects","setProjects","accordion","openAnimation","Panel","text","onPress","newProjects","getElementById"],"mappings":"wcAGe,SAASA,EAAT,GAAkD,IAA7BC,EAA4B,EAA5BA,SAAUC,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,OACpD,OACE,qCACE,mBAAQC,KAAK,OAAb,SAAqBF,IACpBC,EAAS,qBAAKE,UAAU,QAAf,SAAwBF,IAAgB,KAClD,8BACE,sBACCF,Q,6BCVLK,EAAK,KAEHC,EAAM,uCAAG,sBAAAC,EAAA,sEACP,IAAIC,SAAQ,SAACC,EAASC,GAC1B,IAAMC,EAAUC,OAAOC,UAAUC,KAAK,SACtCH,EAAQI,gBAAkB,SAAUC,GAClC,IAAMX,EAAKW,EAAMC,OAAOC,OAEnBb,EAAGc,iBAAiBC,SAAS,aAEhCf,EAAGgB,kBAAkB,WAAY,CAAEC,eAAe,IAE/CjB,EAAGc,iBAAiBC,SAAS,YAElBf,EAAGgB,kBAAkB,UAAW,CAAEC,eAAe,IACnDC,YAAY,YAAa,YAAa,CAAEC,QAAQ,KAGhEb,EAAQc,UAAY,SAAUT,GAC5BX,EAAKW,EAAMC,OAAOC,OAClBT,EAAQJ,IAEVM,EAAQe,QAAU,WAChBhB,IACAiB,QAAQC,MAAM,8DAtBL,mFAAH,qDA0BCC,EAAU,uCAAG,WAAOC,EAAOC,GAAd,SAAAxB,EAAA,sEAClBD,IADkB,uBAEX,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMC,EAAUN,EACb2B,YAAY,CAACF,GAAQ,aACrBG,YAAYH,GACZI,IAAIH,GACPpB,EAAQc,UAAY,SAAUT,GAC5B,IAAMmB,EAAKnB,EAAMC,OAAOC,OACxBT,EAAQ0B,GACR9B,EAAG+B,SAGLzB,EAAQe,QAAU,WAChBhB,IACAiB,QAAQC,MAAR,UAAiBE,EAAjB,mDAfoB,mFAAH,wDAoBVO,EAAa,uCAAG,WAAOP,GAAP,SAAAvB,EAAA,sEACrBD,IADqB,uBAEd,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMqB,EAAO,GACPpB,EAAUN,EACb2B,YAAYF,EAAO,YACnBG,YAAYH,GACZQ,aACH3B,EAAQc,UAAY,SAAUT,GAC5B,IAAMuB,EAASvB,EAAMC,OAAOC,OAC5B,GAAIqB,EAAQ,CACV,IAAMC,EAAI,aAAKL,GAAII,EAAOE,YAAeF,EAAOG,OAChDX,EAAKY,KAAKH,GACVD,EAAOK,gBAEPnC,EAAQsB,GACR1B,EAAG+B,SAGPzB,EAAQe,QAAU,WAChBhB,IACAiB,QAAQC,MAAR,UAAiBE,EAAjB,mDArBuB,mFAAH,sDA0Bbe,EAAiB,uCAAG,WAAOf,EAAOgB,EAAWC,GAAzB,SAAAxC,EAAA,sEACzBD,IADyB,uBAElB,IAAIE,SAAQ,SAACC,EAASC,GACjC,IAAMqB,EAAO,GACPiB,EAAQC,YAAYC,KAAKH,GACzBpC,EAAUN,EACb2B,YAAYF,EAAO,YACnBG,YAAYH,GACZqB,MAAML,GACNR,WAAWU,GACdrC,EAAQc,UAAY,SAAUT,GAC5B,IAAMuB,EAASvB,EAAMC,OAAOC,OAC5B,GAAIqB,EAAQ,CACV,IAAMC,EAAI,aAAKL,GAAII,EAAOE,YAAeF,EAAOG,OAChDX,EAAKY,KAAKH,GACVD,EAAOK,gBAEPnC,EAAQsB,GACR1B,EAAG+B,SAGPzB,EAAQe,QAAU,WAChBhB,IACAiB,QAAQC,MAAR,UAAiBE,EAAjB,mDAvB2B,mFAAH,0DC3DxBsB,EAAO,IAAKA,KA6OHC,qBA3Of,YAAiC,IAAlBC,EAAiB,EAAjBA,KAAMC,EAAW,EAAXA,QACbC,EAAUC,KAAKC,MAAMC,eAAeC,QAAQ,eAC5CC,EAAWJ,KAAKC,MAAMC,eAAeC,QAAQ,gBAC3CE,EAAiCR,EAAjCQ,cAAeC,EAAkBT,EAAlBS,cA8CvB,OACE,eAAChE,EAAD,CAAWE,OAAQuD,EAAQQ,KAAM9D,OAAQ2D,EAASG,KAAlD,UACE,8BACE,2CACE7D,KAAK,OACL8D,MAAM,4BACFH,EAAc,OAAQ,CACxBI,aAAc,IAAIC,QAJtB,aAOE,cAACf,EAAD,0CAEF,2CACEgB,YAAa,EACbxC,QAASmC,EAAc,UACnBD,EAAc,QAAS,CACzBO,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAJvC,6DASA,2CACE3C,QAASmC,EAAc,aACnBD,EAAc,WAAY,CAC5BO,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oBAHvC,wCASF,qBAAKnE,UAAU,YAAf,oDACA,8BACE,kBAAMgD,KAAN,UACE,+BACEoB,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEoB,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEoB,YAAY,sBACRV,EAAc,wBAIxB,qBAAK1D,UAAU,YAAf,sEACA,8BACE,kBAAMgD,KAAN,UACE,+BACEoB,YAAY,8CACRV,EAAc,WAGtB,kBAAMV,KAAN,OAEF,qBAAKhD,UAAU,YAAf,sEACA,8BACE,kBAAMgD,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,iBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,iBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,oBAIxB,sBACA,8BACE,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,iBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,iBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,oBAIxB,qBAAK1D,UAAU,YAAf,wFACA,8BACE,kBAAMgD,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,wBAIxB,sBACA,8BACE,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,qBAGtB,kBAAMV,KAAN,UACE,+BACEqB,KAAK,SACLD,YAAY,sBACRV,EAAc,wBAIxB,8BACE,mBAAMV,KAAN,WACE,qBAAKhD,UAAU,YAAf,gEACA,+BACEqE,KAAK,SACLD,YAAY,wCACRV,EAAc,gBAGtB,mBAAMV,KAAN,WACE,qBAAKhD,UAAU,YAAf,0DACA,+BACEqE,KAAK,SACLD,YAAY,kCACRV,EAAc,kBAIxB,sBAIA,mBAAQW,KAAK,UAAUC,QA/NP,WAClBpB,EAAKqB,eAAe,CAAEC,OAAO,IAAQ,SAAChD,GACpC,GAAKA,EAqCH,IAAMiD,KAAK,6CAAW,OArCZ,CACV,IAAMC,EAAWxB,EAAKyB,iBACtBD,EAASE,KAAOC,YAAOH,EAASE,KAAM,cACtCF,EAASI,UAAY1B,EAAQrB,GAC7B2C,EAASK,WAAatB,EAAS1B,GAC/B2C,EAASM,YAAc,GAEvB,IAAMC,EAAU,SAACC,EAAaC,GAAd,OACdC,SAASF,GAAeE,SAASD,IAC7BE,EAAQ,GACVX,EAASY,WAAWD,EAAM9C,KAAKmC,EAASY,WACxCZ,EAASa,WAAWF,EAAM9C,KAAKmC,EAASa,WACxCb,EAASc,WAAWH,EAAM9C,KAAKmC,EAASc,WACxCd,EAASe,WAAWJ,EAAM9C,KAAKmC,EAASe,WACxCf,EAASgB,WAAWL,EAAM9C,KAAKmC,EAASgB,WACxChB,EAASiB,WAAWN,EAAM9C,KAAKmC,EAASiB,WAC5CjB,EAASkB,QAAUP,EAAMQ,OAASR,EAAMS,KAAK,KAAO,GACpDpB,EAASqB,QAAUV,EAAMQ,OACrBR,EAAMW,OAAOf,GAAWI,EAAMQ,OAC9B,GAEJ,IAAMI,EAAY,GACdvB,EAASwB,eAAeD,EAAU1D,KAAKmC,EAASwB,eAChDxB,EAASyB,eAAeF,EAAU1D,KAAKmC,EAASyB,eAChDzB,EAAS0B,eAAeH,EAAU1D,KAAKmC,EAAS0B,eAChD1B,EAAS2B,eAAeJ,EAAU1D,KAAKmC,EAAS2B,eAChD3B,EAAS4B,eAAeL,EAAU1D,KAAKmC,EAAS4B,eAChD5B,EAAS6B,eAAeN,EAAU1D,KAAKmC,EAAS6B,eACpD7B,EAAS8B,YAAcP,EAAUJ,OAASI,EAAUH,KAAK,KAAO,GAChEpB,EAAS+B,YAAcR,EAAUJ,OAC7BI,EAAUD,OAAOf,GAAWgB,EAAUJ,OACtC,GAEJpE,EAAW,UAAWiD,GAAUgC,MAAK,WACnCvD,EAAQwD,QAAQ,wBA2LpB,gC,wFClPC,WAAyBhF,GAAzB,SAAAxB,EAAA,sDAgBLoB,QAAQqF,IAAIjF,GACZkF,IAAWC,iBACT,wBADF,uCAIE,WAAOtF,EAAOiC,GAAd,eAAAtD,EAAA,0DACMqB,EADN,sBACmBA,EADnB,uBAEuBuF,IAAa,CAChCtD,WAIA9B,OACAqF,aAAc,CAAC,IAAK,OARxB,OAEQC,EAFR,OAWEC,EACED,EACA,cACA,2EAdJ,2CAJF,yDAjBK,4C,sBA4CP,IAUMC,EAAiB,SAACvF,EAAMwF,EAAUC,GACtC,IAAMC,EAAO,IAAIC,KAAK,CAAC3F,GAAO,CAAE0C,KAAM+C,IAChCG,EAAM/G,OAAOgH,IAAIC,gBAAgBJ,GACvCK,EAAYH,EAAKJ,EAAUC,GAC3BO,YAAW,WACTnH,OAAOgH,IAAII,gBAAgBL,KAC1B,MAGCG,EAAc,SAAC/F,EAAMwF,GACzB,IAAMhH,EAAI0H,SAASC,cAAc,KACjC3H,EAAE4H,KAAOpG,EACTxB,EAAE6H,SAAWb,EACbU,SAASI,KAAKC,YAAY/H,GAC1BA,EAAEgI,MAAQ,gBACVhI,EAAEiI,QACFjI,EAAEkI,UCnEErF,EAAO,IAAKA,K,yECFZA,GAAO,IAAKA,KACZsF,GAAY,CAChB,CACEvG,GAAI,EACJ6B,KAAM,+DACN2E,QAAQ,GAEV,CACExG,GAAI,EACJ6B,KAAM,+DACN2E,QAAQ,GAEV,CACExG,GAAI,EACJ6B,KAAM,+DACN2E,QAAQ,GAEV,CACExG,GAAI,EACJ6B,KAAM,+DACN2E,QAAQ,IAgCGC,oBA5Bf,YAA6C,IAArBpF,EAAoB,EAApBA,QAASD,EAAW,EAAXA,QAQ/B,OACE,4BACE,4BACGmF,GAAUG,KAAI,SAAChF,GAAD,OACb,cAAC,GAAD,CACEiF,UAAWjF,EAAS8E,OAEpBI,MAAOlF,EAAS8E,OAAS,GAAK,qBAC9BjE,QAAS,YAfK,SAACb,GACnBA,EAAS8E,SACXhF,eAAeqF,QAAQ,aAAcvF,KAAKwF,UAAUzF,IACpDG,eAAeqF,QAAQ,cAAevF,KAAKwF,UAAUpF,IACrDN,EAAQZ,KAAK,iBAYLuG,CAAgBrF,IALpB,SAQGA,EAASG,MANLH,EAAS1B,cCpCpBgH,GAAS,IAAMA,O,qBCGrBC,IAASC,OACP,cAAC,KAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,cAAcC,UAAWC,IACrC,cAAC,IAAD,CAAOF,KAAK,eAAeC,UHLlB,YAA6B,IAAZhG,EAAW,EAAXA,QACxBC,EAAUC,KAAKC,MAAMC,eAAeC,QAAQ,eAC5CC,EAAWJ,KAAKC,MAAMC,eAAeC,QAAQ,gBAFV,EAGX6F,mBAAS,IAHE,mBAGlCC,EAHkC,KAGzBC,EAHyB,KA0BzC,OArBAC,qBAAU,WACR/G,EAAkB,UAAW,YAAaW,EAAQrB,IAAI2E,MAAK,SAAC+C,GAC1DF,EAAWE,QAEZ,CAACrG,EAAQrB,KAkBV,eAACpC,EAAD,CAAWE,OAAQuD,EAAQQ,KAAM9D,OAAQ2D,EAASG,KAAlD,UACE,4BACG0F,EAAQb,KAAI,SAACiB,GAAD,OACX,cAAC,EAAD,CAAsBf,MAAOe,EAAO9E,KAApC,SACG8E,EAAOC,UADCD,EAAO3H,SAKtB,sBACA,8BACE,kBAAMiB,KAAN,UACE,mBAAQqB,KAAK,UAAUC,QA3BR,WACrBnB,EAAQZ,KAAK,gBA0BP,wCAIF,kBAAMS,KAAN,UACE,mBAAQqB,KAAK,UAAUC,QA5BL,WACxB,GAAIgF,EAAQzD,OAAQ,CAClB,IAAM+D,EAAcN,EAAQO,OAC1B,IAAIC,MAAM,EAAIR,EAAQzD,QAAQkE,KAAK,KAErCxI,QAAQqF,IAAIgD,GDzBX,SAAP,2BC0BMI,CAAU,CAAEV,QAASM,SAErB,IAAMnF,KAAK,yDAAa,IAoBpB,qCGrCJ,cAAC,IAAD,CAAOyE,KAAK,UAAUC,UCZb,WACb,OAAO,4CDYH,cAAC,IAAD,CAAOA,UDPE,WAAiB,IAAD,EACGE,mBAAS,IADZ,mBACtBY,EADsB,KACZC,EADY,KAqC7B,OAlCAV,qBAAU,WACRvH,EAAc,YAAYyE,MAAK,SAAC+C,GAC9BS,EAAYT,QAEb,IA+BD,eAAC9J,EAAD,CAAWE,OAAO,2BAAlB,UACE,mBAAWsK,WAAS,EAACC,cAAe,GAApC,SACGH,EAASxB,KAAI,SAACrF,GAAD,OACZ,kBAAWiH,MAAX,CAGEvK,OAAQsD,EAAQQ,KAHlB,SAKE,cAAC,GAAD,CAAcR,QAASA,KAHlBA,EAAQrB,SAOnB,sBACA,mBAAQsC,KAAK,UAAUC,QA1CD,WACxByE,GACE,2BACA,KACA,CACE,CACEuB,KAAM,gBAER,CACEA,KAAM,eACNC,QAAS,SAACjI,GACR,OAAIA,EACKb,EAAW,WAAY,CAAEmC,KAAMtB,IAASoE,MAAK,SAAC3E,GACnD,IAAMyI,EAAW,sBAAOP,GAAP,CAAiB,CAAElI,KAAI6B,KAAMtB,KAC9C4H,EAAYM,MAGPpK,QAAQE,YAKvB,UACA,KACA,CAAC,gDAkBD,uDCzCJuH,SAAS4C,eAAe,W","file":"static/js/main.690c18f9.chunk.js","sourcesContent":["import React from \"react\";\nimport { WingBlank, WhiteSpace, NavBar } from \"antd-mobile\";\n\nexport default function Container({ children, navBar, header }) {\n  return (\n    <>\n      <NavBar mode=\"dark\">{navBar}</NavBar>\n      {header ? <div className=\"title\">{header}</div> : null}\n      <WingBlank>\n        <WhiteSpace />\n        {children}\n      </WingBlank>\n    </>\n  );\n}\n","let db = null;\n\nconst initDB = async () =>\n  await new Promise((resolve, reject) => {\n    const request = window.indexedDB.open(\"ljjDB\");\n    request.onupgradeneeded = function (event) {\n      const db = event.target.result;\n      let objectStore = null;\n      if (!db.objectStoreNames.contains(\"projects\")) {\n        //项目表\n        db.createObjectStore(\"projects\", { autoIncrement: true });\n      }\n      if (!db.objectStoreNames.contains(\"columns\")) {\n        //柱记录表\n        objectStore = db.createObjectStore(\"columns\", { autoIncrement: true });\n        objectStore.createIndex(\"projectId\", \"projectId\", { unique: false });\n      }\n    };\n    request.onsuccess = function (event) {\n      db = event.target.result;\n      resolve(db);\n    };\n    request.onerror = function () {\n      reject();\n      console.error(\"数据库初始化失败！\");\n    };\n  });\n\nexport const insertData = async (store, data) => {\n  await initDB();\n  return await new Promise((resolve, reject) => {\n    const request = db\n      .transaction([store], \"readwrite\")\n      .objectStore(store)\n      .add(data);\n    request.onsuccess = function (event) {\n      const id = event.target.result;\n      resolve(id);\n      db.close();\n      //   console.log(`${store}数据添加成功！`);\n    };\n    request.onerror = function () {\n      reject();\n      console.error(`${store}数据添加失败！`);\n    };\n  });\n};\n//查询所有数据\nexport const selectAllData = async (store) => {\n  await initDB();\n  return await new Promise((resolve, reject) => {\n    const data = [];\n    const request = db\n      .transaction(store, \"readonly\")\n      .objectStore(store)\n      .openCursor();\n    request.onsuccess = function (event) {\n      const cursor = event.target.result;\n      if (cursor) {\n        const item = { id: cursor.primaryKey, ...cursor.value };\n        data.push(item);\n        cursor.continue();\n      } else {\n        resolve(data);\n        db.close();\n      }\n    };\n    request.onerror = function () {\n      reject();\n      console.error(`${store}数据查询失败！`);\n    };\n  });\n};\n//根据索引条件查询数据\nexport const selectDataByIndex = async (store, indexName, params) => {\n  await initDB();\n  return await new Promise((resolve, reject) => {\n    const data = [];\n    const range = IDBKeyRange.only(params);\n    const request = db\n      .transaction(store, \"readonly\")\n      .objectStore(store)\n      .index(indexName)\n      .openCursor(range);\n    request.onsuccess = function (event) {\n      const cursor = event.target.result;\n      if (cursor) {\n        const item = { id: cursor.primaryKey, ...cursor.value };\n        data.push(item);\n        cursor.continue();\n      } else {\n        resolve(data);\n        db.close();\n      }\n    };\n    request.onerror = function () {\n      reject();\n      console.error(`${store}数据查询失败！`);\n    };\n  });\n};\n","import { format } from \"date-fns\";\nimport { createForm } from \"rc-form\";\nimport {\n  Button,\n  InputItem,\n  List,\n  DatePicker,\n  WhiteSpace,\n  Flex,\n  Toast,\n} from \"antd-mobile\";\n\nimport Container from \"../../components/Container\";\nimport { insertData } from \"../../utils/indexDB\";\n\nconst Item = List.Item;\n\nfunction Add({ form, history }) {\n  const project = JSON.parse(sessionStorage.getItem(\"curProject\"));\n  const template = JSON.parse(sessionStorage.getItem(\"curTemplate\"));\n  const { getFieldProps, getFieldError } = form;\n\n  const handleClick = () => {\n    form.validateFields({ force: true }, (error) => {\n      if (!error) {\n        const formData = form.getFieldsValue();\n        formData.date = format(formData.date, \"yyyy-MM-dd\");\n        formData.projectId = project.id;\n        formData.templateId = template.id;\n        formData.section_s_a = \"\";\n        //计算平均值\n        const reducer = (accumulator, currentValue) =>\n          parseInt(accumulator) + parseInt(currentValue);\n        const space = [];\n        if (formData.space_m_1) space.push(formData.space_m_1);\n        if (formData.space_m_2) space.push(formData.space_m_2);\n        if (formData.space_m_3) space.push(formData.space_m_3);\n        if (formData.space_m_4) space.push(formData.space_m_4);\n        if (formData.space_m_5) space.push(formData.space_m_5);\n        if (formData.space_m_6) space.push(formData.space_m_6);\n        formData.space_m = space.length ? space.join(\",\") : \"\";\n        formData.space_a = space.length\n          ? space.reduce(reducer) / space.length\n          : \"\";\n\n        const space_non = [];\n        if (formData.space_non_m_1) space_non.push(formData.space_non_m_1);\n        if (formData.space_non_m_2) space_non.push(formData.space_non_m_2);\n        if (formData.space_non_m_3) space_non.push(formData.space_non_m_3);\n        if (formData.space_non_m_4) space_non.push(formData.space_non_m_4);\n        if (formData.space_non_m_5) space_non.push(formData.space_non_m_5);\n        if (formData.space_non_m_6) space_non.push(formData.space_non_m_6);\n        formData.space_non_m = space_non.length ? space_non.join(\",\") : \"\";\n        formData.space_non_a = space_non.length\n          ? space_non.reduce(reducer) / space_non.length\n          : \"\";\n\n        insertData(\"columns\", formData).then(() => {\n          history.replace(\"/record/list\");\n        });\n      } else {\n        Toast.fail(\"必填项未填写！\", 2);\n      }\n    });\n  };\n\n  return (\n    <Container navBar={project.name} header={template.name}>\n      <List>\n        <DatePicker\n          mode=\"date\"\n          title=\"选择日期\"\n          {...getFieldProps(\"date\", {\n            initialValue: new Date(),\n          })}\n        >\n          <Item>检测时间</Item>\n        </DatePicker>\n        <InputItem\n          labelNumber={7}\n          error={!!getFieldError(\"equip\")}\n          {...getFieldProps(\"equip\", {\n            rules: [{ required: true, message: \"必填\" }],\n          })}\n        >\n          检测设备及名称\n        </InputItem>\n        <InputItem\n          error={!!getFieldError(\"position\")}\n          {...getFieldProps(\"position\", {\n            rules: [{ required: true, message: \"必填\" }],\n          })}\n        >\n          柱位置\n        </InputItem>\n      </List>\n      <div className=\"sub-title\">截面尺寸（mm）</div>\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            placeholder=\"实测值\"\n            {...getFieldProps(\"section_s_m_1\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            placeholder=\"实测值\"\n            {...getFieldProps(\"section_s_m_2\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            placeholder=\"实测值\"\n            {...getFieldProps(\"section_s_m_3\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <div className=\"sub-title\">柱纵筋实测分布（mm）</div>\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            placeholder=\"柱纵筋实测分布\"\n            {...getFieldProps(\"bar\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item />\n      </Flex>\n      <div className=\"sub-title\">加密区箍筋间距（mm）</div>\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_1\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_2\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_3\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <WhiteSpace />\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_4\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_5\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_m_6\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <div className=\"sub-title\">非加密区实测箍筋间距（mm）</div>\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_1\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_2\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_3\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <WhiteSpace />\n      <Flex>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_4\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_5\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <InputItem\n            type=\"number\"\n            placeholder=\"实测值\"\n            {...getFieldProps(\"space_non_m_6\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <Flex>\n        <Flex.Item>\n          <div className=\"sub-title\">设计箍筋间距（mm）</div>\n          <InputItem\n            type=\"number\"\n            placeholder=\"设计箍筋间距\"\n            {...getFieldProps(\"space_d\")}\n          ></InputItem>\n        </Flex.Item>\n        <Flex.Item>\n          <div className=\"sub-title\">加密区长度（mm）</div>\n          <InputItem\n            type=\"number\"\n            placeholder=\"加密区长度\"\n            {...getFieldProps(\"length\")}\n          ></InputItem>\n        </Flex.Item>\n      </Flex>\n      <WhiteSpace />\n      {/* <Button type=\"primary\" onClick={handleClick}>\n        导出\n      </Button> */}\n      <Button type=\"primary\" onClick={handleClick}>\n        保存\n      </Button>\n    </Container>\n  );\n}\n\nexport default createForm()(Add);\n","import createReport from \"docx-templates\";\nimport JSZipUtils from \"jszip-utils\";\n\nexport async function genReport(data) {\n  //上传模版\n  // const template = await readFileIntoArrayBuffer(file);\n  // const report = await createReport({\n  //   template,\n  //   data: {\n  //     name: \"John\",\n  //     surname: \"Appleseed\",\n  //   },\n  //   cmdDelimiter: [\"{\", \"}\"],\n  // });\n  // saveDataToFile(\n  //   report,\n  //   \"report.docx\",\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n  // );\n  console.log(data);\n  JSZipUtils.getBinaryContent(\n    \"./templates/F-05.docx\",\n    // \"./templates/template.docx\",\n    // \"./templates/myTemplate.docx\",\n    async (error, template) => {\n      if (error) throw error;\n      const report = await createReport({\n        template,\n        // data: {\n        //   columns: [{}, {}],\n        // },\n        data,\n        cmdDelimiter: [\"{\", \"}\"],\n      });\n      // Save report\n      saveDataToFile(\n        report,\n        \"report.docx\",\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n      );\n    }\n  );\n}\n\n// ==============================================\n// Helpers\n// ==============================================\nconst readFileIntoArrayBuffer = async (fd) =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = reject;\n    reader.onload = () => {\n      resolve(reader.result);\n    };\n    reader.readAsArrayBuffer(fd);\n  });\n\nconst saveDataToFile = (data, fileName, mimeType) => {\n  const blob = new Blob([data], { type: mimeType });\n  const url = window.URL.createObjectURL(blob);\n  downloadURL(url, fileName, mimeType);\n  setTimeout(() => {\n    window.URL.revokeObjectURL(url);\n  }, 1000);\n};\n\nconst downloadURL = (data, fileName) => {\n  const a = document.createElement(\"a\");\n  a.href = data;\n  a.download = fileName;\n  document.body.appendChild(a);\n  a.style = \"display: none\";\n  a.click();\n  a.remove();\n};\n","import React, { useState, useEffect } from \"react\";\nimport { List, Button, WhiteSpace, Flex, Toast } from \"antd-mobile\";\nimport Container from \"../../components/Container\";\nimport { selectDataByIndex } from \"../../utils/indexDB\";\nimport { genReport } from \"../../utils/index\";\n\nconst Item = List.Item;\n\nexport default function Rlist({ history }) {\n  const project = JSON.parse(sessionStorage.getItem(\"curProject\"));\n  const template = JSON.parse(sessionStorage.getItem(\"curTemplate\"));\n  const [columns, setColumns] = useState([]);\n\n  useEffect(() => {\n    selectDataByIndex(\"columns\", \"projectId\", project.id).then((res) => {\n      setColumns(res);\n    });\n  }, [project.id]);\n\n  const handleAddClick = () => {\n    history.push(\"/record/add\");\n  };\n\n  const handleExportClick = () => {\n    if (columns.length) {\n      const fullColumns = columns.concat(\n        new Array(4 - columns.length).fill({})\n      );\n      console.log(fullColumns);\n      genReport({ columns: fullColumns });\n    } else {\n      Toast.fail(\"没有要导出的记录！\", 2);\n    }\n  };\n  return (\n    <Container navBar={project.name} header={template.name}>\n      <List>\n        {columns.map((column) => (\n          <Item key={column.id} extra={column.date}>\n            {column.position}\n          </Item>\n        ))}\n      </List>\n      <WhiteSpace />\n      <Flex>\n        <Flex.Item>\n          <Button type=\"primary\" onClick={handleAddClick}>\n            添加记录\n          </Button>\n        </Flex.Item>\n        <Flex.Item>\n          <Button type=\"default\" onClick={handleExportClick}>\n            导出\n          </Button>\n        </Flex.Item>\n      </Flex>\n    </Container>\n  );\n}\n","import React from 'react';\nimport { List, WingBlank } from 'antd-mobile';\nimport { withRouter } from 'react-router-dom';\n\nconst Item = List.Item;\nconst templates = [\n  {\n    id: 1,\n    name: '钢筋混凝土柱检测记录',\n    enable: true,\n  },\n  {\n    id: 2,\n    name: '钢筋混凝土梁检测记录',\n    enable: false,\n  },\n  {\n    id: 3,\n    name: '墙钢筋及厚度检测记录',\n    enable: false,\n  },\n  {\n    id: 4,\n    name: '板钢筋及厚度检测记录',\n    enable: false,\n  },\n];\n\nfunction TemplateList({ project, history }) {\n  const handleItemClick = (template) => {\n    if (template.enable) {\n      sessionStorage.setItem('curProject', JSON.stringify(project));\n      sessionStorage.setItem('curTemplate', JSON.stringify(template));\n      history.push('/record/List');\n    }\n  };\n  return (\n    <WingBlank>\n      <List>\n        {templates.map((template) => (\n          <Item\n            disabled={!template.enable}\n            key={template.id}\n            extra={template.enable ? '' : '不可用'}\n            onClick={() => {\n              handleItemClick(template);\n            }}\n          >\n            {template.name}\n          </Item>\n        ))}\n      </List>\n    </WingBlank>\n  );\n}\n\nexport default withRouter(TemplateList);\n","import React, { useState, useEffect } from \"react\";\nimport { WhiteSpace, Modal, Button, Accordion } from \"antd-mobile\";\nimport Container from \"../components/Container\";\nimport TemplateList from \"../components/TemplateList\";\nimport { insertData, selectAllData } from \"../utils/indexDB\";\n\nconst prompt = Modal.prompt;\n\nexport default function Main() {\n  const [projects, setProjects] = useState([]);\n\n  useEffect(() => {\n    selectAllData(\"projects\").then((res) => {\n      setProjects(res);\n    });\n  }, []);\n\n  const handleButtonClick = () => {\n    prompt(\n      \"项目名称\",\n      null,\n      [\n        {\n          text: \"取消\",\n        },\n        {\n          text: \"确定\",\n          onPress: (value) => {\n            if (value) {\n              return insertData(\"projects\", { name: value }).then((id) => {\n                const newProjects = [...projects, { id, name: value }];\n                setProjects(newProjects);\n              });\n            } else {\n              return Promise.reject();\n            }\n          },\n        },\n      ],\n      \"default\",\n      null,\n      [\"请输入项目名称\"]\n    );\n  };\n\n  return (\n    <Container navBar=\"项目列表\">\n      <Accordion accordion openAnimation={{}}>\n        {projects.map((project) => (\n          <Accordion.Panel\n            // style={{ marginBottom: 15 }}\n            key={project.id}\n            header={project.name}\n          >\n            <TemplateList project={project} />\n          </Accordion.Panel>\n        ))}\n      </Accordion>\n      <WhiteSpace />\n      <Button type=\"primary\" onClick={handleButtonClick}>\n        创建新项目\n      </Button>\n    </Container>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Record from './containers/record/Record';\nimport Add from './containers/record/Add';\nimport List from './containers/record/List';\nimport Main from './containers/Main';\nimport { HashRouter, Switch, Route } from 'react-router-dom';\nimport './index.css';\n\nReactDOM.render(\n  <HashRouter>\n    <Switch>\n      <Route path=\"/record/Add\" component={Add} />\n      <Route path=\"/record/List\" component={List} />\n      <Route path=\"/record\" component={Record} />\n      <Route component={Main} />\n    </Switch>\n  </HashRouter>,\n  document.getElementById('root')\n);\n","import React from 'react';\n\nexport default function Record() {\n  return <div>Record</div>;\n}\n"],"sourceRoot":""}