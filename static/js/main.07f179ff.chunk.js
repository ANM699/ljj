(this.webpackJsonpljj=this.webpackJsonpljj||[]).push([[0],{341:function(e,t){},343:function(e,t){},355:function(e,t,n){},356:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(16),a=n.n(r),s=(n(84),n(36)),o=n.n(s),i=(n(63),n(27)),u=n.n(i),l=(n(205),n(111)),j=n.n(l),p=n(157),m=n(37),d=(n(128),n(77)),b=n.n(d),h=(n(129),n(78)),O=n.n(h),_=(n(214),n(147)),f=n.n(_),x=n(2);function v(e){var t=e.children,n=e.navBar,c=e.header;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f.a,{mode:"dark",children:n}),c?Object(x.jsx)("div",{className:"title",children:c}):null,Object(x.jsxs)(O.a,{children:[Object(x.jsx)(u.a,{}),t]})]})}n(65);var y=n(29),I=n.n(y),g=n(13),w=I.a.Item,S=[{id:1,name:"\u94a2\u7b4b\u6df7\u51dd\u571f\u67f1\u68c0\u6d4b\u8bb0\u5f55",store:"columns",enable:!0},{id:2,name:"\u94a2\u7b4b\u6df7\u51dd\u571f\u6881\u68c0\u6d4b\u8bb0\u5f55",store:"beams",enable:!1},{id:3,name:"\u5899\u94a2\u7b4b\u53ca\u539a\u5ea6\u68c0\u6d4b\u8bb0\u5f55",store:"walls",enable:!1},{id:4,name:"\u677f\u94a2\u7b4b\u53ca\u539a\u5ea6\u68c0\u6d4b\u8bb0\u5f55",store:"floors",enable:!1}];var k=Object(g.g)((function(e){var t=e.project,n=e.history;return Object(x.jsx)(O.a,{children:Object(x.jsx)(I.a,{children:S.map((function(e){return Object(x.jsx)(w,{disabled:!e.enable,extra:e.enable?"":"\u4e0d\u53ef\u7528",onClick:function(){!function(e){e.enable&&(sessionStorage.setItem("curProject",JSON.stringify(t)),sessionStorage.setItem("curTemplate",JSON.stringify(e)),n.push("/records"))}(e)},children:e.name},e.id)}))})})})),P=n(12),N=n.n(P),V=n(23),C=null,q=function(){var e=Object(V.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=window.indexedDB.open("ljjDB",1);n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("projects")||t.createObjectStore("projects",{keyPath:"id",autoIncrement:!0}),t.objectStoreNames.contains("columns")||t.createObjectStore("columns",{keyPath:"id",autoIncrement:!0}).createIndex("projectId","projectId",{unique:!1}),t.objectStoreNames.contains("beams")||t.createObjectStore("beams",{keyPath:"id",autoIncrement:!0}).createIndex("projectId","projectId",{unique:!1}),t.objectStoreNames.contains("walls")||t.createObjectStore("walls",{keyPath:"id",autoIncrement:!0}).createIndex("projectId","projectId",{unique:!1}),t.objectStoreNames.contains("floors")||t.createObjectStore("floors",{keyPath:"id",autoIncrement:!0}).createIndex("projectId","projectId",{unique:!1})},n.onsuccess=function(t){C=t.target.result,e(C)},n.onerror=function(){t(),console.error("\u6570\u636e\u5e93\u521d\u59cb\u5316\u5931\u8d25\uff01")}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(V.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,c){var r=C.transaction([t],"readwrite").objectStore(t).add(n);r.onsuccess=function(t){var n=t.target.result;e(n),C.close()},r.onerror=function(){c(),console.error("".concat(t,"\u6570\u636e\u6dfb\u52a0\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(V.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,n){var c=[],r=C.transaction(t,"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var n=t.target.result;if(n){var r=n.value;c.push(r),n.continue()}else e(c),C.close()},r.onerror=function(){n(),console.error("".concat(t,"\u6570\u636e\u67e5\u8be2\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(V.a)(N.a.mark((function e(t,n,c){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,r){var a=[],s=IDBKeyRange.only(c),o=C.transaction(t,"readonly").objectStore(t).index(n).openCursor(s);o.onsuccess=function(t){var n=t.target.result;if(n){var c=n.value;a.push(c),n.continue()}else e(a),C.close()},o.onerror=function(){r(),console.error("".concat(t,"\u6570\u636e\u67e5\u8be2\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),D=function(){var e=Object(V.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,c){var r=C.transaction(t).objectStore(t).get(n);r.onsuccess=function(t){var n=t.target.result;e(n),C.close()},r.onerror=function(){c(),console.error("".concat(t,"\u6570\u636e\u67e5\u8be2\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(V.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,c){var r=C.transaction(t,"readwrite").objectStore(t).put(n);r.onsuccess=function(){e(),C.close()},r.onerror=function(){c(),console.error("".concat(t,"\u6570\u636e\u66f4\u65b0\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(V.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,new Promise((function(e,c){var r=C.transaction(t,"readwrite").objectStore(t).delete(n);r.onsuccess=function(){e(),C.close()},r.onerror=function(){c(),console.error("".concat(t,"\u6570\u636e\u5220\u9664\u5931\u8d25\uff01"))}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=b.a.prompt;n(130);var L=n(9),U=n.n(L),A=(n(228),n(14)),M=n.n(A),H=(n(236),n(148)),K=n.n(H),z=(n(133),n(80)),G=n.n(z),Q=n(11),W=n(361),X=n(156),Y=function(e){return e.length?(e.reduce((function(e,t){return parseInt(e)+parseInt(t)}))/e.length).toFixed(1):""},Z=function(e,t,n){return e.length>t?e:e.concat(new Array(t-e.length).fill(n))},$=function(e,t,n){for(var c=[],r=0;r<e.length;r+=t)c.push({records:Z(e.slice(r,r+t),t,{}),date:n,equip:e[r].equip});return c},ee=I.a.Item;var te=Object(X.a)()((function(e){var t=e.form,n=e.history,r=e.match,a=JSON.parse(sessionStorage.getItem("curProject")),s=JSON.parse(sessionStorage.getItem("curTemplate")),i=Object(c.useState)(null),l=Object(m.a)(i,2),j=l[0],p=l[1];Object(c.useEffect)((function(){var e=r.params;if(e.id){var t=e.id;D("columns",parseInt(t)).then((function(e){p(e)}))}}),[r.params]);var d=t.getFieldProps,b=t.getFieldError;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(I.a,{children:[Object(x.jsx)(K.a,Object(Q.a)(Object(Q.a)({mode:"date",title:"\u9009\u62e9\u65e5\u671f"},d("date",{initialValue:j?new Date(j.date):new Date})),{},{children:Object(x.jsx)(ee,{children:"\u68c0\u6d4b\u65f6\u95f4"})})),Object(x.jsx)(M.a,Object(Q.a)(Object(Q.a)({labelNumber:7,error:!!b("equip")},d("equip",{initialValue:j?j.equip:"",rules:[{required:!0,message:"\u5fc5\u586b"}]})),{},{children:"\u68c0\u6d4b\u8bbe\u5907\u53ca\u540d\u79f0"})),Object(x.jsx)(M.a,Object(Q.a)(Object(Q.a)({error:!!b("position")},d("position",{initialValue:j?j.position:"",rules:[{required:!0,message:"\u5fc5\u586b"}]})),{},{children:"\u67f1\u4f4d\u7f6e"}))]}),Object(x.jsx)("div",{className:"sub-title",children:"\u622a\u9762\u5c3a\u5bf8\uff08mm\uff09"}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({placeholder:"\u5b9e\u6d4b\u503c"},d("section_s_m_1",{initialValue:j?j.section_s_m_1:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({placeholder:"\u5b9e\u6d4b\u503c"},d("section_s_m_2",{initialValue:j?j.section_s_m_2:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({placeholder:"\u5b9e\u6d4b\u503c"},d("section_s_m_3",{initialValue:j?j.section_s_m_3:""})))})]}),Object(x.jsx)("div",{className:"sub-title",children:"\u67f1\u7eb5\u7b4b\u5b9e\u6d4b\u5206\u5e03\uff08mm\uff09"}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({placeholder:"\u67f1\u7eb5\u7b4b\u5b9e\u6d4b\u5206\u5e03"},d("bar",{initialValue:j?j.bar:""})))}),Object(x.jsx)(U.a.Item,{})]}),Object(x.jsx)("div",{className:"sub-title",children:"\u52a0\u5bc6\u533a\u7b8d\u7b4b\u95f4\u8ddd\uff08mm\uff09"}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_1",{initialValue:j?j.space_m_1:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_2",{initialValue:j?j.space_m_2:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_3",{initialValue:j?j.space_m_3:""})))})]}),Object(x.jsx)(u.a,{}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_4",{initialValue:j?j.space_m_4:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_5",{initialValue:j?j.space_m_5:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_m_6",{initialValue:j?j.space_m_6:""})))})]}),Object(x.jsx)("div",{className:"sub-title",children:"\u975e\u52a0\u5bc6\u533a\u5b9e\u6d4b\u7b8d\u7b4b\u95f4\u8ddd\uff08mm\uff09"}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_1",{initialValue:j?j.space_non_m_1:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_2",{initialValue:j?j.space_non_m_2:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_3",{initialValue:j?j.space_non_m_3:""})))})]}),Object(x.jsx)(u.a,{}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_4",{initialValue:j?j.space_non_m_4:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_5",{initialValue:j?j.space_non_m_5:""})))}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u5b9e\u6d4b\u503c"},d("space_non_m_6",{initialValue:j?j.space_non_m_6:""})))})]}),Object(x.jsxs)(U.a,{children:[Object(x.jsxs)(U.a.Item,{children:[Object(x.jsx)("div",{className:"sub-title",children:"\u8bbe\u8ba1\u7b8d\u7b4b\u95f4\u8ddd\uff08mm\uff09"}),Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u8bbe\u8ba1\u7b8d\u7b4b\u95f4\u8ddd"},d("space_d",{initialValue:j?j.space_d:""})))]}),Object(x.jsxs)(U.a.Item,{children:[Object(x.jsx)("div",{className:"sub-title",children:"\u52a0\u5bc6\u533a\u957f\u5ea6\uff08mm\uff09"}),Object(x.jsx)(M.a,Object(Q.a)({type:"number",placeholder:"\u52a0\u5bc6\u533a\u957f\u5ea6"},d("length",{initialValue:j?j.length:""})))]})]}),Object(x.jsx)(u.a,{}),Object(x.jsx)(o.a,{type:"primary",onClick:function(){t.validateFields({force:!0},(function(e){if(e)G.a.fail("\u5fc5\u586b\u9879\u672a\u586b\u5199\uff01",2);else{var c=t.getFieldsValue();c.date=Object(W.a)(c.date,"yyyy-MM-dd"),c.projectId=a.id,c.templateId=s.id,c.section_s_a="";var r=[];c.space_m_1&&r.push(c.space_m_1),c.space_m_2&&r.push(c.space_m_2),c.space_m_3&&r.push(c.space_m_3),c.space_m_4&&r.push(c.space_m_4),c.space_m_5&&r.push(c.space_m_5),c.space_m_6&&r.push(c.space_m_6),c.space_m=r.length?r.join(","):"",c.space_a=Y(r);var o=[];c.space_non_m_1&&o.push(c.space_non_m_1),c.space_non_m_2&&o.push(c.space_non_m_2),c.space_non_m_3&&o.push(c.space_non_m_3),c.space_non_m_4&&o.push(c.space_non_m_4),c.space_non_m_5&&o.push(c.space_non_m_5),c.space_non_m_6&&o.push(c.space_non_m_6),c.space_non_m=o.length?o.join(","):"",c.space_non_a=Y(o),j?E("columns",Object(Q.a)({id:j.id},c)).then((function(){n.goBack()})):B("columns",c).then((function(){n.goBack()}))}}))},children:"\u4fdd\u5b58"})]})})),ne=(n(329),n(152)),ce=n.n(ne),re=(n(331),n(153)),ae=n.n(re),se=n(154),oe=n.n(se),ie=n(155),ue=n.n(ie);function le(){return(le=Object(V.a)(N.a.mark((function e(t,n,c){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){ue.a.getBinaryContent("./templates/".concat(c,".docx"),function(){var c=Object(V.a)(N.a.mark((function c(a,s){var o;return N.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return a&&r(a),c.next=3,oe()({template:s,data:t,cmdDelimiter:["{","}"]});case 3:o=c.sent,je(o,n,"application/vnd.openxmlformats-officedocument.wordprocessingml.document"),e();case 6:case"end":return c.stop()}}),c)})));return function(e,t){return c.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=function(e,t,n){var c=new Blob([e],{type:n}),r=window.URL.createObjectURL(c);pe(r,t,n),setTimeout((function(){window.URL.revokeObjectURL(r)}),1e3)},pe=function(e,t){var n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.style="display: none",n.click(),n.remove()},me=I.a.Item,de=b.a.alert;function be(e){var t,n=e.history,r=JSON.parse(sessionStorage.getItem("curProject")),a=JSON.parse(sessionStorage.getItem("curTemplate")),s=Object(c.useState)([]),i=Object(m.a)(s,2),l=i[0],j=i[1],p=Object(c.useState)(!1),d=Object(m.a)(p,2),b=d[0],h=d[1],O=(t="date",l.reduce((function(e,n){var c=n[t];return e[c]||(e[c]=[]),e[c].push(n),e}),{}));Object(c.useEffect)((function(){F(a.store,"projectId",r.id).then((function(e){var t=e.sort((function(e,t){return e.date<t.date?-1:0}));j(t)}))}),[r.id,a.store]);return Object(x.jsxs)(x.Fragment,{children:[Object.keys(O).map((function(e){return Object(x.jsx)(I.a,{renderHeader:function(){return e},children:O[e].map((function(e){return Object(x.jsx)(ae.a,{autoClose:!0,right:[{text:"\u5220\u9664",onPress:function(){return t=e.id,void de("","\u786e\u5b9a\u5220\u9664\u8be5\u8bb0\u5f55\uff1f",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",onPress:function(){R("columns",t).then((function(){var e=l.filter((function(e){return e.id!==t}));j(e)}))}}]);var t},style:{backgroundColor:"#F4333C",color:"white"}}],children:Object(x.jsx)(me,{onClick:function(){var t;t=e.id,n.push("/edit/".concat(t))},children:e.position})},e.id)}))},e)})),Object(x.jsx)(u.a,{}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(o.a,{type:"primary",onClick:function(){n.push("/edit")},children:"\u6dfb\u52a0\u8bb0\u5f55"})}),Object(x.jsx)(U.a.Item,{children:Object(x.jsx)(o.a,{type:"default",onClick:function(){if(l.length){h(!0);var e=r.name;(function(e,t,n){return le.apply(this,arguments)})({projectName:e,pages:function(e,t){var n=[];for(var c in e)n=n.concat($(e[c],t,c));return n}(O,4)},"".concat(e,"-").concat(a.name),a.store).then((function(){h(!1)}))}else G.a.fail("\u6ca1\u6709\u8981\u5bfc\u51fa\u7684\u8bb0\u5f55\uff01",2)},children:"\u5bfc\u51fa"})})]}),Object(x.jsx)(ce.a,{toast:!0,text:"\u5bfc\u51fa\u4e2d...",animating:b})]})}var he=n(74);n(355);a.a.render(Object(x.jsx)(he.a,{children:Object(x.jsxs)(g.d,{children:[Object(x.jsx)(g.b,{path:"/",exact:!0,component:function(){var e=Object(c.useState)([]),t=Object(m.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){J("projects").then((function(e){r(e)}))}),[]),Object(x.jsxs)(v,{navBar:"\u9879\u76ee\u5217\u8868",children:[Object(x.jsx)(j.a,{accordion:!0,openAnimation:{},children:n.map((function(e){return Object(x.jsx)(j.a.Panel,{header:e.name,children:Object(x.jsx)(k,{project:e})},e.id)}))}),Object(x.jsx)(u.a,{}),Object(x.jsx)(o.a,{type:"primary",onClick:function(){T("\u9879\u76ee\u540d\u79f0",null,[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",onPress:function(e){return e?B("projects",{name:e}).then((function(t){var c=[].concat(Object(p.a)(n),[{id:t,name:e}]);r(c)})):Promise.reject()}}],"default",null,["\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0"])},children:"\u521b\u5efa\u65b0\u9879\u76ee"})]})}}),Object(x.jsx)(g.b,{component:function(){var e=JSON.parse(sessionStorage.getItem("curProject")),t=JSON.parse(sessionStorage.getItem("curTemplate"));return e&&t?Object(x.jsx)(v,{navBar:e.name,header:t.name,children:Object(x.jsxs)(g.d,{children:[Object(x.jsx)(g.b,{path:"/records",component:be}),Object(x.jsx)(g.b,{path:"/edit",exact:!0,component:te}),Object(x.jsx)(g.b,{path:"/edit/:id",component:te})]})}):Object(x.jsx)(g.a,{to:"/"})}})]})}),document.getElementById("root"))}},[[356,1,2]]]);
//# sourceMappingURL=main.07f179ff.chunk.js.map