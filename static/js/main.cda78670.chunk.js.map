{"version":3,"sources":["utils/index.js","App.js","index.js"],"names":["data","a","JSZipUtils","getBinaryContent","error","template","createReport","cmdDelimiter","report","saveDataToFile","fileName","mimeType","blob","Blob","type","url","window","URL","createObjectURL","downloadURL","setTimeout","revokeObjectURL","document","createElement","href","download","body","appendChild","style","click","remove","Item","createForm","form","getFieldProps","backgroundColor","labelNumber","mode","title","onClick","console","log","getFieldsValue","formData","c","position","section","mValue1","mValue2","mValue3","genReport","ReactDOM","render","getElementById"],"mappings":"ydAGO,WAAyBA,GAAzB,SAAAC,EAAA,sDAiBLC,IAAWC,iBACT,wBADF,uCAEE,WAAOC,EAAOC,GAAd,eAAAJ,EAAA,0DACMG,EADN,sBACmBA,EADnB,uBAEuBE,IAAa,CAChCD,WAWAL,OACAO,aAAc,CAAC,IAAK,OAfxB,OAEQC,EAFR,OAkBEC,EACED,EACA,cACA,2EArBJ,2CAFF,yDAjBK,4C,sBAiDP,IAUMC,EAAiB,SAACT,EAAMU,EAAUC,GACtC,IAAMC,EAAO,IAAIC,KAAK,CAACb,GAAO,CAAEc,KAAMH,IAChCI,EAAMC,OAAOC,IAAIC,gBAAgBN,GACvCO,EAAYJ,EAAKL,EAAUC,GAC3BS,YAAW,WACTJ,OAAOC,IAAII,gBAAgBN,KAC1B,MAGCI,EAAc,SAACnB,EAAMU,GACzB,IAAMT,EAAIqB,SAASC,cAAc,KACjCtB,EAAEuB,KAAOxB,EACTC,EAAEwB,SAAWf,EACbY,SAASI,KAAKC,YAAY1B,GAC1BA,EAAE2B,MAAQ,gBACV3B,EAAE4B,QACF5B,EAAE6B,U,OChEEC,EAAO,IAAKA,KAyDHC,qBAvDf,YAAwB,IAATC,EAAQ,EAARA,KAiBLC,EAAkBD,EAAlBC,cACR,OACE,8BACE,sBACA,oBAAMN,MAAO,CAAEO,gBAAiB,OAAhC,UACE,6CAAeD,EAAc,gBAA7B,2CACA,2CAAWE,YAAa,GAAOF,EAAc,kBAA7C,6DAGA,2CACEG,KAAK,OACLC,MAAM,eACFJ,EAAc,eAHpB,aAKE,cAACH,EAAD,0CAEF,2CAAWjB,KAAK,UAAaoB,EAAc,aAA3C,2CAGA,6CAAeA,EAAc,aAA7B,qCACA,2CAAWpB,KAAK,UAAaoB,EAAc,YAA3C,sCAGA,2CAAWpB,KAAK,UAAaoB,EAAc,YAA3C,sCAGA,2CAAWpB,KAAK,UAAaoB,EAAc,YAA3C,yCAIF,sBACA,mBAAQpB,KAAK,UAAUyB,QAzCP,WAClBC,QAAQC,IAAIR,EAAKS,kBACjB,IAAMC,EAAWV,EAAKS,iBAChBE,EAAI,CACRC,SAAUF,EAASE,SACnBC,QAAS,CAACH,EAASI,QAASJ,EAASK,QAASL,EAASM,WDzBtD,SAAP,2BC4BIC,CADU,2BAAQP,GAAR,IAAkBC,QAkC1B,gCCzDNO,IAASC,OAAO,cAAC,EAAD,IAAS9B,SAAS+B,eAAe,W","file":"static/js/main.cda78670.chunk.js","sourcesContent":["import createReport from \"docx-templates\";\r\nimport JSZipUtils from \"jszip-utils\";\r\n\r\nexport async function genReport(data) {\r\n  //上传模版\r\n  // const template = await readFileIntoArrayBuffer(file);\r\n  // const report = await createReport({\r\n  //   template,\r\n  //   data: {\r\n  //     name: \"John\",\r\n  //     surname: \"Appleseed\",\r\n  //   },\r\n  //   cmdDelimiter: [\"{\", \"}\"],\r\n  // });\r\n  // saveDataToFile(\r\n  //   report,\r\n  //   \"report.docx\",\r\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n  // );\r\n\r\n  JSZipUtils.getBinaryContent(\r\n    \"./templates/F-05.docx\",\r\n    async (error, template) => {\r\n      if (error) throw error;\r\n      const report = await createReport({\r\n        template,\r\n        // data: {\r\n        //   projectName: \"测试项目\",\r\n        //   equipmentName: \"设备\",\r\n        //   detectDate: \"2021-4-15\",\r\n        //   reportNo: \"292831930\",\r\n        //   c: {\r\n        //     position: \"北\",\r\n        //     section: [23, 21, 36],\r\n        //   },\r\n        // },\r\n        data,\r\n        cmdDelimiter: [\"{\", \"}\"],\r\n      });\r\n      // Save report\r\n      saveDataToFile(\r\n        report,\r\n        \"report.docx\",\r\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n      );\r\n    }\r\n  );\r\n}\r\n\r\n// ==============================================\r\n// Helpers\r\n// ==============================================\r\nconst readFileIntoArrayBuffer = async (fd) =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onerror = reject;\r\n    reader.onload = () => {\r\n      resolve(reader.result);\r\n    };\r\n    reader.readAsArrayBuffer(fd);\r\n  });\r\n\r\nconst saveDataToFile = (data, fileName, mimeType) => {\r\n  const blob = new Blob([data], { type: mimeType });\r\n  const url = window.URL.createObjectURL(blob);\r\n  downloadURL(url, fileName, mimeType);\r\n  setTimeout(() => {\r\n    window.URL.revokeObjectURL(url);\r\n  }, 1000);\r\n};\r\n\r\nconst downloadURL = (data, fileName) => {\r\n  const a = document.createElement(\"a\");\r\n  a.href = data;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.style = \"display: none\";\r\n  a.click();\r\n  a.remove();\r\n};\r\n","// import logo from \"./logo.svg\";\r\nimport { createForm } from \"rc-form\";\r\nimport {\r\n  Button,\r\n  InputItem,\r\n  List,\r\n  DatePicker,\r\n  Stepper,\r\n  WingBlank,\r\n  WhiteSpace,\r\n} from \"antd-mobile\";\r\nimport { genReport } from \"./utils/index\";\r\n// import \"./App.css\";\r\n\r\nconst Item = List.Item;\r\n\r\nfunction App({ form }) {\r\n  //上传模版\r\n  // const fileInput = useRef(null);\r\n  // const handleClick = () => {\r\n  //   const file = fileInput.current.inputRef.inputRef.files[0];\r\n  //   genReport(file);\r\n  // };\r\n  const handleClick = () => {\r\n    console.log(form.getFieldsValue());\r\n    const formData = form.getFieldsValue();\r\n    const c = {\r\n      position: formData.position,\r\n      section: [formData.mValue1, formData.mValue2, formData.mValue3],\r\n    };\r\n    const data = { ...formData, c };\r\n    genReport(data);\r\n  };\r\n  const { getFieldProps } = form;\r\n  return (\r\n    <WingBlank>\r\n      <WhiteSpace />\r\n      <List style={{ backgroundColor: \"red\" }}>\r\n        <InputItem {...getFieldProps(\"projectName\")}>项目名称</InputItem>\r\n        <InputItem labelNumber={7} {...getFieldProps(\"equipmentName\")}>\r\n          检测设备及名称\r\n        </InputItem>\r\n        <DatePicker\r\n          mode=\"date\"\r\n          title=\"Select Date\"\r\n          {...getFieldProps(\"detectDate\")}\r\n        >\r\n          <Item>检测时间</Item>\r\n        </DatePicker>\r\n        <InputItem type=\"number\" {...getFieldProps(\"reportNo\")}>\r\n          报告编号\r\n        </InputItem>\r\n        <InputItem {...getFieldProps(\"position\")}>柱位置</InputItem>\r\n        <InputItem type=\"number\" {...getFieldProps(\"mValue1\")}>\r\n          实测值1\r\n        </InputItem>\r\n        <InputItem type=\"number\" {...getFieldProps(\"mValue2\")}>\r\n          实测值2\r\n        </InputItem>\r\n        <InputItem type=\"number\" {...getFieldProps(\"mValue3\")}>\r\n          实测值3\r\n        </InputItem>\r\n      </List>\r\n      <WhiteSpace />\r\n      <Button type=\"primary\" onClick={handleClick}>\r\n        导出\r\n      </Button>\r\n    </WingBlank>\r\n  );\r\n}\r\n\r\nexport default createForm()(App);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\n// import reportWebVitals from './reportWebVitals';\r\n// import { Button } from \"antd-mobile\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n// ReactDOM.render(<Button>Start</Button>, document.getElementById(\"root\"));\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n// reportWebVitals();\r\n"],"sourceRoot":""}