{"version":3,"sources":["components/Container.js","utils/index.js","containers/record/Add.js","components/TemplateList.js","utils/indexDB.js","containers/Main.js","index.js","containers/record/List.js","containers/record/Record.js"],"names":["Container","children","Item","createForm","form","projectName","sessionStorage","getItem","templateName","getFieldProps","getFieldError","mode","className","title","initialValue","Date","labelNumber","error","rules","required","message","placeholder","type","onClick","validateFields","force","console","log","getFieldsValue","formData","date","format","templates","id","name","enable","withRouter","project","history","map","template","disabled","extra","setItem","push","handleItemClick","db","initDB","a","Promise","resolve","reject","request","window","indexedDB","open","onupgradeneeded","event","target","result","objectStoreNames","contains","createObjectStore","autoIncrement","onsuccess","onerror","insertData","store","data","transaction","objectStore","add","close","selectAllData","openCursor","cursor","item","key","value","continue","prompt","ReactDOM","render","path","component","Add","useState","projects","setProjects","useEffect","then","res","accordion","openAnimation","Panel","header","text","onPress","newProjects","document","getElementById"],"mappings":"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","file":"static/js/main.482e2a76.chunk.js","sourcesContent":["import React from 'react';\r\nimport { WingBlank, WhiteSpace } from 'antd-mobile';\r\n\r\nexport default function Container({ children }) {\r\n  return (\r\n    <WingBlank>\r\n      <WhiteSpace />\r\n      {children}\r\n    </WingBlank>\r\n  );\r\n}\r\n","import createReport from \"docx-templates\";\r\nimport JSZipUtils from \"jszip-utils\";\r\n\r\nexport async function genReport(data) {\r\n  //上传模版\r\n  // const template = await readFileIntoArrayBuffer(file);\r\n  // const report = await createReport({\r\n  //   template,\r\n  //   data: {\r\n  //     name: \"John\",\r\n  //     surname: \"Appleseed\",\r\n  //   },\r\n  //   cmdDelimiter: [\"{\", \"}\"],\r\n  // });\r\n  // saveDataToFile(\r\n  //   report,\r\n  //   \"report.docx\",\r\n  //   \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n  // );\r\n\r\n  JSZipUtils.getBinaryContent(\r\n    \"./templates/F-05.docx\",\r\n    async (error, template) => {\r\n      if (error) throw error;\r\n      const report = await createReport({\r\n        template,\r\n        // data: {\r\n        //   projectName: \"测试项目\",\r\n        //   equipmentName: \"设备\",\r\n        //   detectDate: \"2021-4-15\",\r\n        //   reportNo: \"292831930\",\r\n        //   c: {\r\n        //     position: \"北\",\r\n        //     section: [23, 21, 36],\r\n        //   },\r\n        // },\r\n        data,\r\n        cmdDelimiter: [\"{\", \"}\"],\r\n      });\r\n      // Save report\r\n      saveDataToFile(\r\n        report,\r\n        \"report.docx\",\r\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n      );\r\n    }\r\n  );\r\n}\r\n\r\n// ==============================================\r\n// Helpers\r\n// ==============================================\r\nconst readFileIntoArrayBuffer = async (fd) =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onerror = reject;\r\n    reader.onload = () => {\r\n      resolve(reader.result);\r\n    };\r\n    reader.readAsArrayBuffer(fd);\r\n  });\r\n\r\nconst saveDataToFile = (data, fileName, mimeType) => {\r\n  const blob = new Blob([data], { type: mimeType });\r\n  const url = window.URL.createObjectURL(blob);\r\n  downloadURL(url, fileName, mimeType);\r\n  setTimeout(() => {\r\n    window.URL.revokeObjectURL(url);\r\n  }, 1000);\r\n};\r\n\r\nconst downloadURL = (data, fileName) => {\r\n  const a = document.createElement(\"a\");\r\n  a.href = data;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.style = \"display: none\";\r\n  a.click();\r\n  a.remove();\r\n};\r\n","// import logo from \"./logo.svg\";\r\nimport { format } from 'date-fns';\r\nimport { createForm } from 'rc-form';\r\nimport {\r\n  Button,\r\n  InputItem,\r\n  List,\r\n  DatePicker,\r\n  WhiteSpace,\r\n  NavBar,\r\n  Flex,\r\n} from 'antd-mobile';\r\n\r\nimport Container from '../../components/Container';\r\nimport { genReport } from '../../utils/index';\r\n\r\nconst Item = List.Item;\r\n\r\nfunction Add({ form }) {\r\n  const handleClick = () => {\r\n    form.validateFields({ force: true }, (error) => {\r\n      if (!error) {\r\n        console.log(form.getFieldsValue());\r\n        const formData = form.getFieldsValue();\r\n        formData.date = format(formData.date, 'yyyy-MM-dd');\r\n        // const c = {\r\n        //   position: formData.position,\r\n        //   section: [formData.mValue1, formData.mValue2, formData.mValue3],\r\n        // };\r\n        // const data = { ...formData, c };\r\n        // console.log(data);\r\n        // genReport(data);\r\n      } else {\r\n        // alert('验证失败');\r\n      }\r\n    });\r\n  };\r\n  const projectName = sessionStorage.getItem('curProject');\r\n  const templateName = sessionStorage.getItem('curTemplate');\r\n  const { getFieldProps, getFieldError } = form;\r\n  return (\r\n    <>\r\n      <NavBar mode=\"dark\">{projectName}</NavBar>\r\n      <div className=\"title\">{templateName}</div>\r\n      <Container>\r\n        <DatePicker\r\n          mode=\"date\"\r\n          title=\"选择日期\"\r\n          {...getFieldProps('date', {\r\n            initialValue: new Date(),\r\n          })}\r\n        >\r\n          <Item>检测时间</Item>\r\n        </DatePicker>\r\n        <InputItem\r\n          labelNumber={7}\r\n          error={!!getFieldError('equip')}\r\n          {...getFieldProps('equip', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          检测设备及名称\r\n        </InputItem>\r\n        <InputItem\r\n          error={!!getFieldError('location')}\r\n          {...getFieldProps('location', {\r\n            rules: [{ required: true, message: '必填' }],\r\n          })}\r\n        >\r\n          柱位置\r\n        </InputItem>\r\n        <div className=\"sub-title\">截面尺寸（mm）</div>\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('section_s_m_1')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('section_s_m_2')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('section_s_m_3')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          {/* <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"平均值\"\r\n              {...getFieldProps('section_s_a')}\r\n            ></InputItem>\r\n          </Flex.Item> */}\r\n        </Flex>\r\n        <div className=\"sub-title\">柱纵筋实测分布（mm）</div>\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"柱纵筋实测分布\"\r\n              {...getFieldProps('bar')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <div className=\"sub-title\">加密区箍筋间距（mm）</div>\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_1')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_2')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_3')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <WhiteSpace />\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_4')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_5')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_m_6')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <div className=\"sub-title\">非加密区实测箍筋间距（mm）</div>\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_1')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_2')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_3')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <WhiteSpace />\r\n        <Flex>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_4')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_5')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <InputItem\r\n              placeholder=\"实测值\"\r\n              {...getFieldProps('space_non_m_6')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <Flex>\r\n          <Flex.Item>\r\n            <div className=\"sub-title\">设计箍筋间距（mm）</div>\r\n            <InputItem\r\n              placeholder=\"设计箍筋间距\"\r\n              {...getFieldProps('space_d')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n          <Flex.Item>\r\n            <div className=\"sub-title\">加密区长度（mm）</div>\r\n            <InputItem\r\n              placeholder=\"加密区长度\"\r\n              {...getFieldProps('length')}\r\n            ></InputItem>\r\n          </Flex.Item>\r\n        </Flex>\r\n        <WhiteSpace />\r\n        {/* <Button type=\"primary\" onClick={handleClick}>\r\n        导出\r\n      </Button> */}\r\n        <Button type=\"primary\" onClick={handleClick}>\r\n          保存\r\n        </Button>\r\n      </Container>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default createForm()(Add);\r\n","import React from 'react';\r\nimport { List, WingBlank } from 'antd-mobile';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nconst Item = List.Item;\r\nconst templates = [\r\n  {\r\n    id: 1,\r\n    name: '钢筋混凝土柱检测记录',\r\n    enable: true,\r\n  },\r\n  {\r\n    id: 2,\r\n    name: '钢筋混凝土梁检测记录',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 3,\r\n    name: '墙钢筋及厚度检测记录',\r\n    enable: false,\r\n  },\r\n  {\r\n    id: 4,\r\n    name: '板钢筋及厚度检测记录',\r\n    enable: false,\r\n  },\r\n];\r\n\r\nfunction TemplateList({ project, history }) {\r\n  const handleItemClick = (template) => {\r\n    if (template.enable) {\r\n      sessionStorage.setItem('curProject', project.name);\r\n      sessionStorage.setItem('curTemplate', template.name);\r\n      history.push('/record/List');\r\n    }\r\n  };\r\n  return (\r\n    <WingBlank>\r\n      <List>\r\n        {templates.map((template) => (\r\n          <Item\r\n            disabled={!template.enable}\r\n            key={template.id}\r\n            extra={template.enable ? '' : '不可用'}\r\n            onClick={() => {\r\n              handleItemClick(template);\r\n            }}\r\n          >\r\n            {template.name}\r\n          </Item>\r\n        ))}\r\n      </List>\r\n    </WingBlank>\r\n  );\r\n}\r\n\r\nexport default withRouter(TemplateList);\r\n","let db = null;\r\n\r\nconst initDB = async () =>\r\n  await new Promise((resolve, reject) => {\r\n    const request = window.indexedDB.open(\"ljjDB\");\r\n    request.onupgradeneeded = function (event) {\r\n      const db = event.target.result;\r\n      if (!db.objectStoreNames.contains(\"projects\")) {\r\n        db.createObjectStore(\"projects\", { autoIncrement: true });\r\n      }\r\n    };\r\n    request.onsuccess = function (event) {\r\n      db = event.target.result;\r\n      resolve(db);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(\"数据库初始化失败！\");\r\n    };\r\n  });\r\n\r\nexport const insertData = async (store, data) => {\r\n  const db = await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const request = db\r\n      .transaction([store], \"readwrite\")\r\n      .objectStore(store)\r\n      .add(data);\r\n    request.onsuccess = function (event) {\r\n      const id = event.target.result;\r\n      resolve(id);\r\n      db.close();\r\n      //   console.log(`${store}数据添加成功！`);\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据添加失败！`);\r\n    };\r\n  });\r\n};\r\n\r\nexport const selectAllData = async (store) => {\r\n  const db = await initDB();\r\n  return await new Promise((resolve, reject) => {\r\n    const data = [];\r\n    const request = db\r\n      .transaction(store, \"readonly\")\r\n      .objectStore(store)\r\n      .openCursor();\r\n    request.onsuccess = function (event) {\r\n      const cursor = event.target.result;\r\n      if (cursor) {\r\n        const item = { id: cursor.key, ...cursor.value };\r\n        data.push(item);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(data);\r\n        db.close();\r\n      }\r\n    };\r\n    request.onerror = function () {\r\n      reject();\r\n      console.error(`${store}数据查询失败！`);\r\n    };\r\n  });\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  List,\r\n  WhiteSpace,\r\n  Modal,\r\n  Button,\r\n  NavBar,\r\n  Accordion,\r\n} from 'antd-mobile';\r\nimport Container from '../components/Container';\r\nimport TemplateList from '../components/TemplateList';\r\nimport { insertData, selectAllData } from '../utils/indexDB';\r\n\r\nconst Item = List.Item;\r\nconst prompt = Modal.prompt;\r\n\r\nexport default function Main() {\r\n  // const db = useContext(DBContext);\r\n  const [projects, setProjects] = useState([]);\r\n  useEffect(() => {\r\n    // console.log(\"1123\");\r\n    selectAllData('projects').then((res) => {\r\n      setProjects(res);\r\n    });\r\n  }, []);\r\n  const handleButtonClick = () => {\r\n    prompt(\r\n      '项目名称',\r\n      null,\r\n      [\r\n        {\r\n          text: '取消',\r\n        },\r\n        {\r\n          text: '确定',\r\n          onPress: (value) => {\r\n            if (value) {\r\n              return insertData('projects', { name: value }).then((id) => {\r\n                const newProjects = [...projects, { id, name: value }];\r\n                setProjects(newProjects);\r\n              });\r\n            } else {\r\n              return Promise.reject();\r\n            }\r\n          },\r\n        },\r\n      ],\r\n      'default',\r\n      null,\r\n      ['请输入项目名称']\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <NavBar mode=\"dark\">项目列表</NavBar>\r\n      <Container>\r\n        <Accordion accordion openAnimation={{}}>\r\n          {projects.map((project) => (\r\n            <Accordion.Panel\r\n              // style={{ marginBottom: 15 }}\r\n              key={project.id}\r\n              header={project.name}\r\n            >\r\n              <TemplateList project={project} />\r\n            </Accordion.Panel>\r\n          ))}\r\n        </Accordion>\r\n        <WhiteSpace />\r\n        <Button type=\"primary\" onClick={handleButtonClick}>\r\n          创建新项目\r\n        </Button>\r\n      </Container>\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Record from './containers/record/Record';\r\nimport Add from './containers/record/Add';\r\nimport List from './containers/record/List';\r\nimport Main from './containers/Main';\r\nimport { HashRouter, Switch, Route } from 'react-router-dom';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <HashRouter>\r\n    <Switch>\r\n      <Route path=\"/record/Add\" component={Add} />\r\n      <Route path=\"/record/List\" component={List} />\r\n      <Route path=\"/record\" component={Record} />\r\n      <Route component={Main} />\r\n    </Switch>\r\n  </HashRouter>,\r\n  document.getElementById('root')\r\n);\r\n","import React from 'react';\r\nimport { NavBar, List, Button, WhiteSpace } from 'antd-mobile';\r\nimport Container from '../../components/Container';\r\n\r\nexport default function Rlist({ history }) {\r\n  const projectName = sessionStorage.getItem('curProject');\r\n  const templateName = sessionStorage.getItem('curTemplate');\r\n\r\n  const handleClick = () => {\r\n    history.push('/record/add');\r\n  };\r\n  return (\r\n    <>\r\n      <NavBar mode=\"dark\">{projectName}</NavBar>\r\n      <div className=\"title\">{templateName}</div>\r\n      <Container>\r\n        <List></List>\r\n        <WhiteSpace />\r\n        <Button type=\"primary\" onClick={handleClick}>\r\n          添加记录\r\n        </Button>\r\n      </Container>\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function Record() {\r\n  return <div>Record</div>;\r\n}\r\n"],"sourceRoot":""}